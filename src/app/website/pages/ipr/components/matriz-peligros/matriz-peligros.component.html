<p-confirmDialog key="matrizp"></p-confirmDialog>
<p-toast  key="mpeligros"></p-toast>
<a style="visibility: hidden" id="dwldLink"></a>

<form [formGroup]="formCreacionMatriz">
    <p-panel header="REGISTRO MATRIZ DE PELIGROS">
    <!-- <p-panel> -->
        <div class="grid">
            <div class="col-6">
                <strong>División:</strong>
                <!-- <area-selector  [disabled]="flagRegistroMatrizAcording" required formControlName="ubicacion"></area-selector>        -->
                <p-dropdown [readonly]="flagRegistroMatrizAcording" required [filter]="true" placeholder="Seleccione una división"[options]="listDivision" appendTo="body" formControlName="ubicacion" (onChange)="cargarPlantaLocalidad($event.value);flagContinuar=false"></p-dropdown>

            </div>
            <div class="col-6">
                <strong>Planta - Localidad:</strong>
                <br/>
                <p-dropdown [readonly]="flagRegistroMatrizAcording" required [filter]="true" placeholder="Seleccione una planta"[options]="planta" appendTo="body" formControlName="planta" ></p-dropdown>
            </div>
        </div>
        <br/>
        <br/>
        <ng-container *ngIf="!flagRegistroMatrizAcording">
            <button *sTienePermiso="'IPECR_PUT_MATRIZPELIGROS'" pButton type="button " icon="bi bi-arrow-right " label="Continuar " (click)="habilitarGuiaProceso()" [disabled]="!formCreacionMatriz.valid && !flagContinuar"></button>
        </ng-container>
    </p-panel>
</form>

<ng-template #blanco1><div class="col-md-6 col-sm-12">
    &nbsp;
</div></ng-template>

<br>
<ng-container *ngIf="flagRegistroMatrizAcording">
    
    <p-accordion [activeIndex]="activeIndex">
        <p-accordionTab *ngIf="flagRegistroMatrizTree">
            <p-header [style]="{'width': '100%'}">
                    <span>GUÍA PROCESOS</span>
                    <button pButton type="button" 
                    icon="bi bi-pencil"
                    class="p-button-primary left-button"
                    title="Editar" 
                    (click)="flagButtonMatrizAcording=true" 
                    *ngIf="!flagButtonMatrizAcording && !flagEliminadoSustituido"></button>
             </p-header>
            <p-treeTable #tt [value]="matrizdescripcion" [columns]="cols" [filterMode]="filterMode"  [tableStyle]="{'min-width':'50rem'}">
                <ng-template pTemplate="header" let-columns>
                    <tr>
                        <th [style]="{'width': '5rem'}">
                            Tipo
                        </th>
                        <th *ngFor="let col of cols">
                            {{ col.header }}
                        </th>
                        <th [style]="{'width': '10rem'}" *ngIf="flagButtonMatrizAcording">
                            <button pButton type="button" 
                            icon="bi bi-plus"
                            class="p-button-primary"
                            tooltipPosition="left"
                            pTooltip="Agregar área"
                            (click)="CRUDAreaTreeFunc(null,'POST')"
                            ></button>
                        </th>
                    </tr>
                    <tr>
                        <th [style]="{'width': '5rem'}">
                        </th>
                        <th *ngFor="let col of cols">
                            <input pInputText type="text" (input)="tt.filter($event.target.value, col.field, col.filterMatchMode)" />
                        </th>
                        <th [style]="{'width': '10rem'}" *ngIf="flagButtonMatrizAcording">
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-rowNode let-rowData="rowData">
                    <tr>
                        <td [style]="{'width': '10rem'}">
                            <ng-container *ngIf="rowNode.level==0">
                                A
                            </ng-container>
                            <ng-container *ngIf="rowNode.level==1">
                                P   
                            </ng-container>
                            <ng-container *ngIf="rowNode.level==2">
                                S
                            </ng-container>
                        </td>
                        <ng-container *ngFor="let col of cols; let i = index">
                            <td>
                                <p-treeTableToggler [rowNode]="rowNode" *ngIf="i === 0"></p-treeTableToggler>
                                {{ rowData[col.field] }}
                            </td>

                        </ng-container>
                        <td style="width: 10rem; display: flex;justify-content: space-evenly;" *ngIf="flagButtonMatrizAcording">
                            <ng-container *ngIf="rowNode.level==0" >
                                <button pButton type="button" 
                                icon="bi bi-plus"
                                tooltipPosition="left"
                                pTooltip="Agregar proceso"
                                (click)="CRUDProcesoTreeFunc(rowData,'POST')"
                                ></button>
                                <button pButton type="button" 
                                icon="bi bi-pencil"
                                class="p-button-success"
                                tooltipPosition="left"
                                pTooltip="Editar área"
                                (click)="CRUDAreaTreeFunc(rowData,'PUT')"
                                ></button>
                                <button pButton type="button" 
                                icon="bi bi-trash"
                                class="p-button-danger"
                                tooltipPosition="left"
                                pTooltip="Eliminar área"
                                (click)="CRUDAreaTreeFunc(rowData,'DELETE')"
                                ></button>
                            </ng-container>
                            <ng-container *ngIf="rowNode.level==1">
                                <button pButton type="button" 
                                icon="bi bi-plus"
                                tooltipPosition="left"
                                pTooltip="Agregar subproceso (cargo/oficio)"
                                (click)="CRUDSubprocesoTreeFunc(rowNode,'POST')"
                                ></button>
                                <button pButton type="button" 
                                class="p-button-success"
                                icon="bi bi-pencil"
                                tooltipPosition="left"
                                pTooltip="Editar proceso"
                                (click)="CRUDProcesoTreeFunc(rowNode,'PUT')"
                                ></button>
                                <button pButton type="button" 
                                class="p-button-danger"
                                icon="bi bi-trash"
                                tooltipPosition="left"
                                pTooltip="Eliminar proceso"
                                (click)="CRUDProcesoTreeFunc(rowNode,'DELETE')"
                                ></button>
                            </ng-container>
                            <ng-container *ngIf="rowNode.level==2">
                                
                                <button pButton type="button" 
                                icon="bi bi-trash"
                                class="p-button-danger"
                                tooltipPosition="left"
                                pTooltip="Eliminar subproceso (cargo/oficio)"
                                (click)="CRUDSubprocesoTreeFunc(rowNode,'DELETE')"
                                ></button>
                            </ng-container>
                        </td>
                    
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td [attr.colspan]="4">No hay guía de procesos registrada.</td>
                    </tr>
                </ng-template>
            </p-treeTable>
            <br/>
            <br/>
            <div *ngIf="flagButtonMatrizAcording && matrizdescripcion.length>0 && !flagRegistroMatriz">
                <button pButton type="button" 
                icon="bi bi-plus"
                label="Crear matriz de peligros"
                (click)="crearMatrizPeligros()">
                </button>
            </div>
            <div *ngIf="flagRegistroMatriz && flagButtonMatrizAcording && matrizdescripcion.length>0">
                <button pButton type="button" 
                icon="bi bi-plus"
                label="Actualizar guía de procesos"
                (click)="crearMatrizPeligros()">
                </button>
            </div>
        </p-accordionTab>
    </p-accordion>
</ng-container>

<ng-container *ngIf="flagRegistroMatriz">
    <p-panel>
        <ng-template pTemplate="header"><div style="display: flex; justify-content: space-between; width: 100%;"><h1><b>MATRIZ DE PELIGROS</b></h1> <div><span>Estado: {{estado}}</span><ng-container *ngIf="idMostrar!=''"><br><span> id: {{idMostrar}}</span></ng-container></div> </div></ng-template>

        <p-accordion [multiple]="true" #acordionMat>

            <p-accordionTab header="I. INFORMACIÓN GENERAL - DESCRIPCIÓN">
                <div >
                    <form [formGroup]="formMatrizGeneral">
                        <div class="accordionTab">
                            <div [class]="(CRUDMatriz!='PUT' || flagEliminadoSustituido)?'overlay-content grid':'overlay grid'">
                                <div class="col-md-6 col-sm-12 gridcol" *ngIf="flagProcesoSubP">
                                    <label for="">Área</label><br>
                                    <!-- <p-dropdown appendTo="body" [filter]="true" required [options]="this.areaMatrizItemList" (onChange)="cargarProceso($event)" >
                                    </p-dropdown> -->
                                    <p-multiSelect formControlName="Area" [style]="{'width':'100%'}" appendTo="body" [filter]="true" required [options]="this.areaMatrizItemList" (onChange)="cargarProceso($event.value)">
                                    </p-multiSelect>
                                </div>
                                <div class="col-md-6 col-sm-12">
                                    &nbsp;
                                </div>
                                <!-- <div class="col-md-6 col-sm-12 gridcol" *ngIf="putArea;else blanco1">
                                    <label for="">Agregar una nueva área de no estar registrada</label><br>
                                    <ng-containter style="display: flex;">
                                        <input type="text">
                                        <button pButton type="button" 
                                        icon="bi bi-plus"
                                        class="p-button-raised p-button-primary"
                                        ></button>
                                    </ng-containter>
                                </div> -->
                                <br>
                                <div class="col-md-6 col-sm-12 gridcol" *ngIf="flagProcesoSubP">
                                    <label for="">Proceso</label>
                                    <!-- <p-dropdown  [style]="{'width':'100%'}" appendTo="body" [filter]="true" required [options]="this.procesoMatrizItemList" (onChange)="cargarSubproceso($event)">
                                    </p-dropdown> -->
                                    <p-multiSelect  formControlName="Proceso" [style]="{'width':'100%'}" appendTo="body" [filter]="true" required [options]="this.procesoMatrizItemList" (onChange)="cargarSubproceso($event.value)">
                                    </p-multiSelect>
                                </div>
                                <div class="col-md-6 col-sm-12">
                                    &nbsp;
                                </div>
                                <!-- <div class="col-md-6 col-sm-12 gridcol" *ngIf="putProceso;else blanco1">
                                    <label for="">Agregar un nuevo proceso de no estar registrado</label><br>
                                    <ng-containter style="display: flex;">
                                        <input type="text">
                                        <button pButton type="button" 
                                        icon="bi bi-plus"
                                        class="p-button-raised p-button-primary"
                                        ></button>
                                    </ng-containter>
                                </div> -->
                                <br>
                                <div class="col-md-6 col-sm-12 gridcol" *ngIf="flagProcesoSubP">
                                    <label for="">Subproceso (cargo/oficio)</label>
                                    <!-- <p-dropdown  [style]="{'width':'100%'}" appendTo="body" [filter]="true" required [options]="this.subprocesoMatrizItemList">
                                    </p-dropdown> -->
                                    <p-multiSelect  formControlName="Subproceso" [style]="{'width':'100%'}" appendTo="body" [filter]="true" required [options]="this.subprocesoMatrizItemList">
                                    </p-multiSelect>
                                </div>
                                <div class="col-md-6 col-sm-12">
                                    &nbsp;
                                </div>
                            </div>
                            
                            <!-- <div class="col-md-6 col-sm-12 gridcol" *ngIf="putSubproceso;else blanco1">
                                <label for="">Agregar un nuevo subproceso (cargo/oficio) de no estar registrado</label><br>
                                <ng-containter style="display: flex;">
                                    <input type="text">
                                    <button pButton type="button" 
                                    icon="bi bi-plus"
                                    class="p-button-raised p-button-primary"
                                    ></button>
                                </ng-containter>
                            </div> -->
                            <br>
                            <br>
                            <div [class]="(flagEliminadoSustituido)?'overlay-content grid':'overlay grid'">
                                <div class="col-md-12 col-sm-12 gridcol">
                                    <label for="">Actividades o tareas</label>
                                    <textarea required cols="10" rows="3" formControlName="Actividades"></textarea>
                                </div>
                                <br>
                                <div class="col-md-12 col-sm-12 gridcol">
                                    <label for="">¿Rutinaria?</label><br>
                                    <div style="display: flex;">
                                        <p-radioButton required name="Rutinaria" label="Sí" [value]="1"  [style]="{'margin-left': '15px'}" [(ngModel)]="flagRutinaria" [ngModelOptions]="{standalone: true}" formControlName="Rutinaria"></p-radioButton>
                                        <p-radioButton name="Rutinaria"  [value]="0" label="No"  [style]="{'margin-left': '15px'}" [(ngModel)]="flagRutinaria" [ngModelOptions]="{standalone: true}" formControlName="Rutinaria"></p-radioButton>
                                    </div>
                                </div>
                                <br>
                                <br>
                                <div class="col-12">
                                    &nbsp;
                                </div>
                                <h3># Expuestos</h3>
                                <div class="col-md-12 col-sm-12 gridcol grid">
                                    <div class="col-md-6 col-sm-12 col-3">
                                        <label for="">Propios</label><br>
                                        <input #positiveNumber min="0" required formControlName="Propios" type="number" [(ngModel)]="sumaP" [ngModelOptions]="{standalone: true}" (input)="sumaExpuestosFunc()">
                                    </div>
                                    <div  class="col-md-6 col-sm-12 col-3">
                                        <label for="">Temporales</label>
                                        <input #positiveNumber min="0" required formControlName="Temporales" type="number" [(ngModel)]="sumaC" [ngModelOptions]="{standalone: true}" (input)="sumaExpuestosFunc()">                              
                                    </div>
                                    <div class="col-md-6 col-sm-12 col-3">
                                        <label for="">Contratistas</label>
                                        <input #positiveNumber min="0"  required formControlName="Contratistas" type="number" [(ngModel)]="sumaT" [ngModelOptions]="{standalone: true}" (input)="sumaExpuestosFunc()"> 
                                    </div>
                                    <div class="col-md-5 col-sm-11 col-2">
                                        <label for="">Total</label>
                                        <input #positiveNumber min="0" type="number" [readonly]="true" [(ngModel)]="sumaExpuestos" [ngModelOptions]="{standalone: true}"> 
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </p-accordionTab>

            <p-accordionTab header="II. IDENTIFICACIÓN DEL PELIGRO" [disabled]="!formMatrizGeneral.valid" [active]="formMatrizGeneral.valid">
                <div [class]="(!formMatrizGeneral.valid || flagEliminadoSustituido)?'overlay-content':'overlay'">
                    <form [formGroup]="formMatrizPeligros">
                        <div class="grid accordionTab">
                            <div class="col-md-6 col-sm-12 gridcol">
                                <label for="">Clasificación</label>
                                <p-dropdown  [filter]="true" required [options]="this.tipoPeligroItemList" formControlName="Peligro" (onChange)="SelectPeligro($event.value,'actual')" >
                                </p-dropdown>
                            </div>
                            <br>
                            <div class="col-md-6 col-sm-12 gridcol">
                                <label for="">Descripción del peligro</label>
                                <p-dropdown  [filter]="true" [options]="this.peligroItemList" formControlName="DescripcionPeligro" (onChange)="SelectEfecto($event.value,'actual')" required></p-dropdown>
                            </div>
                            <br>
                            <div class="col-md-12 col-sm-12 gridcol">
                                <label for="">Fuente generadora</label>
                                <textarea cols="10" rows="3" formControlName="FuenteGeneradora" required></textarea>
                            </div>
                            <br>
                            <div class="col-md-12 col-sm-12 gridcol">
                                <label for="">Posibles consecuencias/efectos a la salud.</label>
                                <textarea [readonly]="true" cols="10" rows="3" formControlName="Efectos"></textarea>
                            </div>
                        </div>
                    </form>
                </div>
            </p-accordionTab>

            <!-- <p-accordionTab header="III. EVALUACIÓN DEL RIESGO CONTROLES EXISTENTES" > -->
            <p-accordionTab header="III. EVALUACIÓN DEL RIESGO CONTROLES EXISTENTES" [disabled]="!formMatrizPeligros.valid">
                <div [class]="(!formMatrizPeligros.valid || flagEliminadoSustituido)?'overlay-content':'overlay'">
                    <form [formGroup]="formMatrizRiesgosC">
                        <div class="grid accordionTab">
                            <div class="col-12 gridcol">
                                
                                <div>
                                    <h2 for="" style="margin-bottom: 4px;" >Control de ingeniería:&nbsp;</h2>
                                    <div style="display: flex;">
                                        <label for="">¿Aplica?</label>&nbsp;
                                        <p-radioButton (onClick)="visualEvaluacionRiesgo('flagControlIng')" name="GRUPO1" label="Sí" [value]="true"  [style]="{'margin-left': '15px'}" [(ngModel)]="flagControlIng" [ngModelOptions]="{standalone: true}"></p-radioButton>
                                        <p-radioButton (onClick)="visualEvaluacionRiesgo('flagControlIng')" name="GRUPO1"  [value]="false" label="No"  [style]="{'margin-left': '15px'}" [(ngModel)]="flagControlIng" [ngModelOptions]="{standalone: true}"></p-radioButton>
                                    </div>
                                </div>
                                <br>
                                <div id="flagControlIng">
                                    <p-table #dtContIng styleClass="material-table" autoLayout="true" selectionMode="single" [(selection)]="controlIng" [value]="controlIngList" [paginator]="true" [rows]="10" >
                                        <ng-template pTemplate="header" let-columns>
                                            <tr>
                                                <th>Fecha creación</th>
                                                <th>Descripción</th>
                                                <th>Tipo de barrera</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p-calendar [class]="controlIngList.length==0?'readonly-calendar':'notreadonly-calendar'" style="width: 100%;" appendTo="body" dateFormat="dd/mm/yy" (onSelect)="dtContIng.filter($event, 'fechaCreacion','contains')"
                                                     placeholder="Buscar..."  [showIcon]="true"></p-calendar>
                                                     <!-- <p-calendar [class]="controlIngList.length==0?'readonly-calendar':'notreadonly-calendar'" style="width: 100%;" appendTo="body" dateFormat="dd/mm/yy" (onSelect)="filtroFechas($event, 'ctrIng')"
                                                     placeholder="Buscar..."  [showIcon]="true"></p-calendar> -->
                                                </td>
                                                <td>
                                                    <span class="p-input-icon-left ml-auto">
                                                        <i class="pi pi-search"></i>
                                                        <input placeholder="Buscar..." [readOnly]="controlIngList.length==0" style="width: 100%;" pInputText type="text" (input)="dtContIng.filter($event.target.value, 'descripcion', 'contains')">
                                                    </span>
                                                </td>
                                                <td>
                                                    <span class="p-input-icon-left ml-auto">
                                                        <i class="pi pi-search"></i>
                                                        <input placeholder="Buscar..." [readOnly]="controlIngList.length==0" style="width: 100%;" pInputText type="text" (input)="dtContIng.filter($event.target.value, 'barrera', 'contains')">
                                                    </span>
                                                </td>
                                                
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-control>
                                            <tr [pSelectableRow]="control" class="table-row table-row-selectable">
                                                <td>{{control.fechaCreacion | date: 'dd/MM/yyyy'}}</td>
                                                <td>{{control.descripcion}}</td>
                                                <td>{{control.barrera}}</td>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="summary" let-rowData>
                                            <tr>
                                                <td colspan="4">
                                                    <div class="flex justify-content-end flex-wrap">
                                                        <button  pButton class="flex m-2 p-button-primary p-button-sm" label="Agregar" icon="pi pi-plus" (click)="controlFunc('POST','ing')"></button>
                                                        <button [disabled]="!controlIng" pButton class="flex m-2 p-button-success p-button-sm" label="Editar" icon="pi pi-pencil" (click)="controlFunc('PUT','ing')"></button>
                                                        <button [disabled]="!controlIng" pButton class="flex m-2 p-button-danger p-button-sm" label="Eliminar" icon="pi pi-trash" (click)="controlFunc('DELETE','ing')"></button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="emptymessage">
                                            <tr>
                                                <td [attr.colspan]="2">No hay control de ingeniería existente</td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                    <!-- <textarea [required]="flagControlIng" formControlName="Ingenieria" cols="10" rows="3" ></textarea> -->
                                </div>
                            </div>
                            <hr>
                            <div class="col-12 gridcol">
                                <div>
                                    <h2 for="" style="margin-bottom: 4px;" >Controles administrativos:&nbsp;</h2>
                                    <div style="display: flex;">
                                        <label for="">¿Aplica?</label>&nbsp;
                                        <p-radioButton (onClick)="visualEvaluacionRiesgo('flagControlAdm')" name="GRUPO2" label="Sí" [value]="true"  [style]="{'margin-left': '15px'}" [(ngModel)]="flagControlAdm" [ngModelOptions]="{standalone: true}"></p-radioButton>
                                        <p-radioButton (onClick)="visualEvaluacionRiesgo('flagControlAdm')" name="GRUPO2"  [value]="false" label="No"  [style]="{'margin-left': '15px'}" [(ngModel)]="flagControlAdm" [ngModelOptions]="{standalone: true}"></p-radioButton>
                                    </div>
                                </div>
                                <br>
                                <!-- <label for="">Controles administrativos:</label> -->
                                <div id="flagControlAdm">
                                    <p-table #dtAdm styleClass="material-table" autoLayout="true" selectionMode="single" [(selection)]="controlAdm" [value]="controlAdmList" [paginator]="true" [rows]="10" >
                                        <ng-template pTemplate="header" let-columns>
                                            <tr>
                                                <th>Fecha creación</th>
                                                <th>Descripción</th>
                                                <th>Tipo de barrera</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <p-calendar [class]="controlAdmList.length==0?'readonly-calendar':'notreadonly-calendar'" style="width: 100%;" appendTo="body" dateFormat="dd/mm/yy" (onSelect)="dtAdm.filter($event, 'fechaCreacion', 'contains')"
                                                     placeholder="Buscar..."  [showIcon]="true"></p-calendar>
                                                    <!-- <s-rangoFechaSelector (onSelect)="dtAdm.filter($event, 'fechaCreacion', 'bt')"></s-rangoFechaSelector> -->

                                                </td>
                                                <td>
                                                    <span class="p-input-icon-left ml-auto">
                                                        <i class="pi pi-search"></i>
                                                        <input placeholder="Buscar..." [readOnly]="controlAdmList.length==0" style="width: 100%;" pInputText type="text" (input)="dtAdm.filter($event.target.value, 'descripcion', 'contains')">
                                                    </span>
                                                </td>
                                                <td>
                                                    <span class="p-input-icon-left ml-auto">
                                                        <i class="pi pi-search"></i>
                                                        <input placeholder="Buscar..." [readOnly]="controlAdmList.length==0" style="width: 100%;" pInputText type="text" (input)="dtAdm.filter($event.target.value, 'barrera', 'contains')">
                                                    </span>
                                                </td>
                                                
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-controlAdm>
                                            <tr [pSelectableRow]="controlAdm" class="table-row table-row-selectable">
                                                <td>{{controlAdm.fechaCreacion  | date: 'dd/MM/yyyy'}}</td>
                                                <td>{{controlAdm.descripcion}}</td>
                                                <td>{{controlAdm.barrera}}</td>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="summary" let-rowData>
                                            <tr>
                                                <td colspan="4">
                                                    <div class="flex justify-content-end flex-wrap">
                                                        <button  pButton class="flex m-2 p-button-primary p-button-sm" label="Agregar" icon="pi pi-plus" (click)="controlFunc('POST','adm')"></button>
                                                        <button [disabled]="!controlAdm" pButton class="flex m-2 p-button-success p-button-sm" label="Editar" icon="pi pi-pencil" (click)="controlFunc('PUT','adm')"></button>
                                                        <button [disabled]="!controlAdm" pButton class="flex m-2 p-button-danger p-button-sm" label="Eliminar" icon="pi pi-trash" (click)="controlFunc('DELETE','adm')"></button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="emptymessage">
                                            <tr>
                                                <td [attr.colspan]="3">No hay control administrativos existente</td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                    <!-- <textarea [required]="flagControlAdm" formControlName="Administrativos" cols="10" rows="3"></textarea> -->
                                </div>
                            </div>
                            <hr>
                            <div class="col-12 gridcol">
                                <div>
                                    <h2 for="" style="margin-bottom: 4px;" >Equipos y elementos de protección personal:&nbsp;</h2>
                                    <div style="display: flex;">
                                        <label for="">¿Aplica?</label>&nbsp;
                                        <p-radioButton (onClick)="visualEvaluacionRiesgo('flagEquiposEle')" name="GRUPO3" label="Sí" [value]="true"  [style]="{'margin-left': '15px'}" [(ngModel)]="flagEquiposEle" [ngModelOptions]="{standalone: true}"></p-radioButton>
                                        <p-radioButton (onClick)="visualEvaluacionRiesgo('flagEquiposEle')" name="GRUPO3"  [value]="false" label="No"  [style]="{'margin-left': '15px'}" [(ngModel)]="flagEquiposEle" [ngModelOptions]="{standalone: true}"></p-radioButton>
                                    </div>
                                </div>
                                <br>
                                <!-- <label for="">Equipos y elementos de protección personal:</label> -->
                                <div id="flagEquiposEle">
                                    <p-table #dtEqu styleClass="material-table" autoLayout="true" selectionMode="single" [(selection)]="controlEqu" [value]="controlEquList" [paginator]="true" [rows]="10" >
                                        <ng-template pTemplate="header" let-columns>
                                            <tr>
                                                <th>Fecha creación</th>
                                                <th>Descripción</th>
                                                <th>Tipo de barrera</th>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <!-- [class]="controlEquList.length==0?'overlay-content':'overlay'" -->
                                                        <p-calendar [class]="controlEquList.length==0?'readonly-calendar':'notreadonly-calendar'" style="width: 100%;" appendTo="body" dateFormat="dd/mm/yy" (onSelect)="dtEqu.filter($event, 'fechaCreacion', 'contains')"
                                                         placeholder="Buscar..."  [showIcon]="true"></p-calendar>
                                                 
                                                    <!-- <div class="calendar-icon-wrapper">
                                                        <p-calendar [class]="controlEquList.length==0?'readonly-calendar':'notreadonly-calendar'" style="width: 100%;" appendTo="body" dateFormat="dd/mm/yy" (onTodayClick)="dt.filter(rangeDatesCreacion, 'fechaCreacion', 'fechaCreacionFilter')"
                                                        (onClearClick)="onResetDate(dt, 'fechaCreacion')" placeholder="Buscar..."  [showIcon]="true"></p-calendar>
                                                    </div> -->
                                                </td>
                                                <td>
                                                    <span class="p-input-icon-left ml-auto">
                                                        <i class="pi pi-search"></i>
                                                        <input placeholder="Buscar..." [readOnly]="controlEquList.length==0" style="width: 100%;" pInputText type="text" (input)="dtEqu.filter($event.target.value, 'descripcion', 'contains')">
                                                    </span>
                                                </td>
                                                <td>
                                                    <span class="p-input-icon-left ml-auto">
                                                        <i class="pi pi-search"></i>
                                                        <input placeholder="Buscar..." [readOnly]="controlEquList.length==0" style="width: 100%;" pInputText type="text" (input)="dtEqu.filter($event.target.value, 'barrera', 'contains')">
                                                    </span>
                                                </td>
                                                
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="body" let-control>
                                            <tr [pSelectableRow]="control" class="table-row table-row-selectable">
                                                <td>{{control.fechaCreacion | date: 'dd/MM/yyyy'}}</td>
                                                <td>{{control.descripcion}}</td>
                                                <td>{{control.barrera}}</td>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="summary" let-rowData>
                                            <tr>
                                                <td colspan="4">
                                                    <div class="flex justify-content-end flex-wrap">
                                                        <button  pButton class="flex m-2 p-button-primary p-button-sm" label="Agregar" icon="pi pi-plus" (click)="controlFunc('POST','equ')"></button>
                                                        <button [disabled]="!controlEqu" pButton class="flex m-2 p-button-success p-button-sm" label="Editar" icon="pi pi-pencil" (click)="controlFunc('PUT','equ')"></button>
                                                        <button [disabled]="!controlEqu" pButton class="flex m-2 p-button-danger p-button-sm" label="Eliminar" icon="pi pi-trash" (click)="controlFunc('DELETE','equ')"></button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </ng-template>
                                        <ng-template pTemplate="emptymessage">
                                            <tr>
                                                <td [attr.colspan]="3">No hay equipos y elementos de protección personal existente</td>
                                            </tr>
                                        </ng-template>
                                    </p-table>
                                    <!-- <textarea  [required]="flagEquiposEle" formControlName="ElementosPro" cols="10" rows="3"></textarea> -->
                                </div>
                            </div>
                        </div>
                    </form>
                    <div *ngIf="tareasListEjecutado.length>0">
                        <br><br>
                        <h2 for="" >Planes de acción ejecutados:</h2>
                        <p-table #dtEje styleClass="material-table" autoLayout="true" selectionMode="single" [(selection)]="tarea" [value]="tareasListEjecutado" [paginator]="true" [rows]="10" >
                            <ng-template pTemplate="header" let-columns>
                                <tr>
                                    <th>Fecha creación</th>
                                    <th>Descripción</th>
                                    <th>Jerarquía de control</th>
                                    <th>Tipo de barrera</th>
                                    <th>Estado del plan de acción</th>
                                </tr>
                                <tr>
                                    <td>
                                        <p-calendar [class]="tareasListEjecutado.length==0?'readonly-calendar':'notreadonly-calendar'" style="width: 100%;" appendTo="body" dateFormat="dd/mm/yy" (onSelect)="dtEje.filter($event, 'fechaCreacion', 'contains')"
                                         placeholder="Buscar..."  [showIcon]="true"></p-calendar>
                                    </td>
                                    <td>
                                        <span class="p-input-icon-left ml-auto">
                                            <i class="pi pi-search"></i>
                                            <input placeholder="Buscar..." [readOnly]="tareasListEjecutado.length==0" style="width: 100%;" pInputText type="text" (input)="dtEje.filter($event.target.value, 'descripcion', 'contains')">
                                        </span>
                                    </td>
                                    <td>
                                        <span class="p-input-icon-left ml-auto">
                                            <i class="pi pi-search"></i>
                                            <input  placeholder="Buscar..." [readOnly]="tareasListEjecutado.length==0" style="width: 100%;" pInputText type="text" (input)="dtEje.filter($event.target.value, 'jerarquia', 'contains')">
                                        </span>
                                    </td>
                                    <td>
                                        <span class="p-input-icon-left ml-auto">
                                            <i class="pi pi-search"></i>
                                            <input  placeholder="Buscar..." [readOnly]="tareasListEjecutado.length==0" style="width: 100%;" pInputText type="text" (input)="dtEje.filter($event.target.value, 'barreras', 'contains')">
                                        </span>
                                    </td>
                                    <td>
                                        <span class="p-input-icon-left ml-auto">
                                            <i class="pi pi-search"></i>
                                            <input  placeholder="Buscar..." [readOnly]="tareasListEjecutado.length==0" style="width: 100%;" pInputText type="text" (input)="dtEje.filter($event.target.value, 'estado', 'contains')">
                                        </span>
                                    </td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-tarea>
                                <tr [pSelectableRow]="tarea" class="table-row table-row-selectable">
                                    <td>{{tarea.fechaCreacion | date: 'dd/MM/yyyy'}}</td>
                                    <td>{{tarea.descripcion}}</td>
                                    <td>{{tarea.jerarquia}}</td>
                                    <td>{{tarea.barreras}}</td>
                                    <td>{{tarea.estado}}</td>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="emptymessage">
                                <tr>
                                    <td [attr.colspan]="4">No hay planes de acción registrados</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>
            </p-accordionTab>

            <p-accordionTab header="IV. VALORACIÓN DEL RIESGO INICIAL" [disabled]="!((!flagControlIng || (flagControlIng && controlIngList.length>0)) && (!flagControlAdm || (flagControlAdm && controlAdmList.length>0)) && (!flagEquiposEle || (flagEquiposEle && controlEquList.length>0))) || !formMatrizPeligros.valid">
                <div [class]="(!formMatrizRiesgosC.valid  || flagEliminadoSustituido)?'overlay-content':'overlay'">
                    <form [formGroup]="formMatrizRiesgosI">
                        <div class="grid accordionTab">
                            <div class="col-12">
                                <p-table [value]="valoracionRI1" [tableStyle]="{ 'min-width': '50rem' }">
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th>    
                                                <a>Nivel de deficiencia (ND)</a>&nbsp;
                                                <button 
                                                pButton type="button"icon="bi bi-question-circle"
                                                    class="p-button-rounded p-button-text"
                                                    pTooltip="Ayuda"
                                                    (click)="imagenFlag('ND')"></button>
                                            </th>
                                            <th>
                                                <a>Nivel de exposición (NE)</a>&nbsp;
                                                <button pButton type="button"icon="bi bi-question-circle"
                                                    class="p-button-rounded p-button-text"
                                                    pTooltip="Ayuda"
                                                    (click)="imagenFlag('NE')"></button>
                                            </th>
                                            <th>
                                                <a>Nivel de probabilidad (NP=ND*NE)</a>&nbsp;
                                                <button pButton type="button" icon="bi bi-question-circle"
                                                    class="p-button-rounded p-button-text"
                                                    pTooltip="Ayuda"
                                                    (click)="imagenFlag('NP')"></button>
                                            </th>
                                            <th style="width:15rem">Interpretación del nivel de probabilidad</th>
                                            <th>
                                                <a>Nivel de consecuencia (NC)</a>
                                                <button 
                                                pButton type="button"icon="bi bi-question-circle"
                                                    class="p-button-rounded p-button-text"
                                                    pTooltip="Ayuda"
                                                    (click)="imagenFlag('NC')"></button>
                                            </th>
                                            <th>
                                                <a>Nivel de riesgo (NR=NP*NC)</a>
                                                <button 
                                                pButton type="button"icon="bi bi-question-circle"
                                                    class="p-button-rounded p-button-text"
                                                    pTooltip="Ayuda"
                                                    (click)="imagenFlag('NR')"></button>
                                            </th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-nivel  let-editing="editing" let-ri="rowIndex">
                                        <tr [pEditableRow]="nivel">
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output">
                                                    <p-dropdown  required formControlName="ND" appendTo="body" [options]="this.ND" [(ngModel)]="nivel['ND']" [ngModelOptions]="{standalone: true}" (onChange)="nivelProbabilidad('inicial')">
                                                    </p-dropdown>
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    <p-dropdown  required formControlName="NE"appendTo="body" [options]="this.NE" [(ngModel)]="nivel['NE']" [ngModelOptions]="{standalone: true}" (onChange)="nivelProbabilidad('inicial')">
                                                    </p-dropdown>
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    {{nivel['NP']}}                                                
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    {{nivel['I']}}
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output">
                                                    <p-dropdown  required formControlName="NC" appendTo="body" [options]="this.NC" [(ngModel)]="nivel['NC']" [ngModelOptions]="{standalone: true}" (onChange)="nivelRiesgo('inicial')">
                                                    </p-dropdown>
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    {{nivel['NR']}}                                                
                                                </ng-template>
                                            </p-cellEditor></td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                                <br>
                                <p-table [value]="valoracionRI2" [tableStyle]="{ 'min-width': '50rem' }">
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th colspan="3" class="text-center">Interpretación del riesgo</th>
                                        </tr>
                                        <tr>
                                            <th>Cuantitativo</th>
                                            <th>Cualitativo</th>
                                            <th>Acción</th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-nivel  let-editing="editing" let-ri="rowIndex">
                                        <tr [pEditableRow]="nivel">
                                            <td [class]="nivel['color']"><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    <b>{{nivel['CN']}}</b>
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td [class]="nivel['color']"><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    <b>{{nivel['CL']}}</b>
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    <textarea [readonly]="true" [(ngModel)]="nivel['accion']" [ngModelOptions]="{standalone: true}"></textarea>                 
                                                </ng-template>
                                            </p-cellEditor></td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                            </div>
                            <!-- <div class="col-md-12 col-sm-12 gridcol">
                                <label for="">Acción:</label>
                                <textarea [readonly]="true" cols="10" rows="5"  [(ngModel)]="accion" [ngModelOptions]="{standalone: true}"></textarea>
                            </div> -->
                        </div>
                        <br>
                        <h1>Evidencia riesgo inicial</h1>
                        <button pButton type="button" (click)="visibleDlgFoto1=true" icon="fa fa-plus" label="Adjuntar evidencia" style="margin-bottom: 10px;" [disabled]="!formMatrizRiesgosI.valid || CRUDMatriz=='PUT' || formMatrizGeneral.value.Subproceso.length>1"></button>

                        <s-documentoUpload tipoEvidencia="matrizRExistente" [(visible)]="visibleDlgFoto1" [modParam]="idMatriz" [modulo]="modulo" (onUpload)="onUpload($event)" [flagPrivado]="false"></s-documentoUpload>
                        <div *ngFor="let doc of documentosList">
                            <table class="dwrapper" *ngIf="doc.proceso=='matrizRExistente'">
                            <tr>
                                <td>
                                <span [class]="doc.extension?.icono" [style.color]="doc.extension?.color"></span>
                                <a style="margin-left: 10px;" (click)="descargarDocumento(doc)">{{doc.nombre}}</a>
                                </td>
                                <td style="text-align: right;">
                                <a class="bi bi-pencil-square" title="Actualizar Descripción" (click)="actualizarDesc(doc)" *ngIf="!readOnly"></a>
                                <a>&nbsp;</a>
                                <a class="pi pi-trash" title="Eliminar documento" (click)="eliminarDocument(doc)" *ngIf="!readOnly" style="color: red;"></a>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                <textarea pInputTextarea [(ngModel)]="doc.descripcion" maxlength="253"></textarea>
                                </td>
                            </tr>
                            </table>
                        </div>
                        <hr>
                        <!-- <h2>¿Este riesgo está en el PPAM?</h2> -->
                        <h2>¿Este riesgo puede generar accidentes mayores?</h2>
                        <div class="grid accordionTab">
                            <div style="display: flex;">
                                <p-radioButton required name="accMayor" label="Sí" [value]="'Sí'"  [style]="{'margin-left': '15px'}" formControlName="accMayor" (onClick)="funcAccidentesMayores()"></p-radioButton>
                                <p-radioButton name="accMayor" label="No" [value]="'No'" [style]="{'margin-left': '15px'}" formControlName="accMayor" (onClick)="funcAccidentesMayores()"></p-radioButton>
                            </div>
                        </div>
                    <!-- </form> -->
                    <br>
                    <div *ngIf="this.formMatrizRiesgosI.value.accMayor=='Sí'">
                        <!-- <form [formGroup]="formValoracionRiesgo"> -->
        
                            <h2>¿Este riesgo está en el PPAM?</h2>

                            <div style="display: flex;">
                                <p-radioButton required name="realizoValoracion" label="Sí" [value]="'Sí'"  [style]="{'margin-left': '15px'}" formControlName="realizoValoracion" (onClick)="planAccionRiesgoInicial()"></p-radioButton>
                                <p-radioButton name="realizoValoracion" label="No" [value]="'No'" [style]="{'margin-left': '15px'}" formControlName="realizoValoracion" (onClick)="planAccionRiesgoInicial()"></p-radioButton>
                            </div>
                            <hr>
                            <div *ngIf="formMatrizRiesgosI.value.realizoValoracion=='Sí'">
                                <h3>Evidencias</h3>
                                <button pButton type="button" (click)="visibleDlgFoto2=true" icon="fa fa-plus" label="Adjuntar soporte" style="margin-bottom: 10px;" [disabled]="CRUDMatriz=='PUT' || formMatrizGeneral.value.Subproceso.length>1"></button>
        
                                <s-documentoUpload tipoEvidencia="matrizERiesgo" [(visible)]="visibleDlgFoto2" [modParam]="idMatriz" [modulo]="modulo" (onUpload)="onUpload($event)" [flagPrivado]="false"></s-documentoUpload>
                                <div *ngFor="let doc of documentosList">
                                    <table class="dwrapper" *ngIf="doc.proceso=='matrizERiesgo'">
                                        <tr>
                                        <td>
                                            <span [class]="doc.extension?.icono" [style.color]="doc.extension?.color"></span>
                                            <a style="margin-left: 10px;" (click)="descargarDocumento(doc)">{{doc.nombre}}</a>
                                        </td>
                                        <td style="text-align: right;">
                                            <a class="bi bi-pencil-square" title="Actualizar Descripción" (click)="actualizarDesc(doc)" *ngIf="!readOnly"></a>
                                            <a>&nbsp;</a>
                                            <a class="pi pi-trash" title="Eliminar documento" (click)="eliminarDocument(doc)" *ngIf="!readOnly" style="color: red;"></a>
                                        </td>
                                        </tr>
                                        <tr>
                                        <td colspan="2">
                                            <textarea pInputTextarea [(ngModel)]="doc.descripcion" maxlength="253"></textarea>
                                        </td>
                                        </tr>
                                    </table>
                                </div>
                            </div>
                            <div id="planAccionInicial">
                                <h3>Plan de acción</h3>
                                <label for="">Descripción</label>
                                <textarea cols="10" rows="3" formControlName="planAccion" [required]="formMatrizRiesgosI.value.realizoValoracion=='No'"></textarea>
                            </div>
                        </div>
                    </form>
                </div>
            </p-accordionTab>

            <p-accordionTab header="V. CONTROL DE RIESGO - PLAN DE ACCIÓN" [disabled]="!formMatrizRiesgosI.valid">
                <!-- <div [class]="(!formMatrizRiesgosI.valid  || flagEliminadoSustituido)?'overlay-content':'overlay'"> -->
                <!-- <p-accordionTab header="V. CONTROL DE RIESGO - PLAN DE ACCIÓN" [disabled]="false"> -->

                <p-table #dtPlanAccion styleClass="material-table" autoLayout="true" selectionMode="single" [(selection)]="tarea" [value]="tareasListPendiente" [paginator]="true" [rows]="10" >
                    <ng-template pTemplate="header" let-columns>
                        <tr>
                            <th>Fecha creación</th>
                            <th>Descripción</th>
                            <th>Jerarquía de control</th>
                            <th>Tipo de barrera</th>
                            <th>Estado del plan de acción</th>
                        </tr>
                        <tr>
                            <td>
                        
                                <div class="calendar-icon-wrapper">
                                    <p-calendar [class]="tareasListPendiente.length==0?'readonly-calendar':'notreadonly-calendar'" style="width: 100%;" appendTo="body" dateFormat="dd/mm/yy" (onSelect)="dtPlanAccion.filter($event, 'fechaCreacion', 'contains')"
                                    placeholder="Buscar..."  [showIcon]="true"></p-calendar>
                                    <!-- <i class="pi pi-search calendar-icon"></i> -->
                                </div>

                            </td>
                            <td>
                                <span class="p-input-icon-left ml-auto">
                                    <i class="pi pi-search"></i>
                                    <input [readOnly]="tareasListPendiente.length==0" pInputText type="text" (input)="dtPlanAccion.filter($event.target.value, 'descripcion', 'contains')" placeholder="Buscar..." />
                                </span>
                            </td>
                            <td>
                                <span class="p-input-icon-left ml-auto">
                                    <i class="pi pi-search"></i>
                                    <input [readOnly]="tareasListPendiente.length==0" pInputText type="text" (input)="dtPlanAccion.filter($event.target.value, 'jerarquia', 'contains')" placeholder="Buscar..." />
                                </span>
                            </td>
                            <td>
                                <span class="p-input-icon-left ml-auto">
                                    <i class="pi pi-search"></i>
                                    <input [readOnly]="tareasListPendiente.length==0" pInputText type="text" (input)="dtPlanAccion.filter($event.target.value, 'barreras', 'contains')" placeholder="Buscar..." />
                                </span>
                            </td>
                            <td>
                                <span class="p-input-icon-left ml-auto">
                                    <i class="pi pi-search"></i>
                                    <input [readOnly]="tareasListPendiente.length==0" pInputText type="text" (input)="dtPlanAccion.filter($event.target.value, 'estado', 'contains')" placeholder="Buscar..." />
                                </span>
                            </td>
                            
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-tarea>
                        <tr [pSelectableRow]="tarea" class="table-row table-row-selectable">
                            <td>{{tarea.fechaCreacion | date: 'dd/MM/yyyy'}}</td>
                            <td>{{tarea.descripcion}}</td>
                            <td>{{tarea.jerarquia}}</td>
                            <td>{{tarea.barreras}}</td>
                            <td>{{tarea.estado}}</td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="summary" let-rowData>
                        <tr [class]="(!formMatrizRiesgosI.valid  || flagEliminadoSustituido)?'overlay-content':'overlay'">
                            <td colspan="4">
                                <div class="flex justify-content-end flex-wrap">
                                    <button [disabled]="flagplanElimsust" pButton class="flex m-2 p-button-primary p-button-sm" label="Agregar" icon="pi pi-plus" (click)="planAccion('POST')"></button>
                                    <button [disabled]="!tarea" pButton class="flex m-2 p-button-success p-button-sm" label="Editar" icon="pi pi-pencil" (click)="planAccion('PUT')"></button>
                                    <button [disabled]="!tarea" pButton class="flex m-2 p-button-danger p-button-sm" label="Eliminar" icon="pi pi-trash" (click)="planAccion('DELETE')"></button>
                                </div>
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td [attr.colspan]="5">No hay planes de acción registrados</td>
                        </tr>
                    </ng-template>
                </p-table>
                
                <!-- </div> -->
            </p-accordionTab>

            <p-accordionTab header="VI. VALORACIÓN DEL RIESGO RESIDUAL" [disabled]="!(this.tareasList.length>0 && (this.tareasListPendiente.length==0) || flagResidual)">
                <div [class]="!(this.tareasList.length>0 && (this.tareasListPendiente.length==0) || flagResidual)?'overlay-content':'overlay'">
                    <form [formGroup]="formMatrizRiesgosIResidual">
                        <div class="grid accordionTab">
                            <div class="col-12">
                                <p-table [value]="valoracionRI1Residual" [tableStyle]="{ 'min-width': '50rem' }" >
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th>    
                                                <a>Nivel de deficiencia (ND)</a>&nbsp;
                                                <button 
                                                pButton type="button"icon="bi bi-question-circle"
                                                    class="p-button-rounded p-button-text"
                                                    pTooltip="Ayuda"
                                                    (click)="imagenFlag('ND')"></button>
                                            </th>
                                            <th>
                                                <a>Nivel de exposición (NE)</a>&nbsp;
                                                <button pButton type="button"icon="bi bi-question-circle"
                                                    class="p-button-rounded p-button-text"
                                                    pTooltip="Ayuda"
                                                    (click)="imagenFlag('NE')"></button>
                                            </th>
                                            <th>
                                                <a>Nivel de probabilidad (NP=ND*NE)</a>&nbsp;
                                                <button pButton type="button" icon="bi bi-question-circle"
                                                    class="p-button-rounded p-button-text"
                                                    pTooltip="Ayuda"
                                                    (click)="imagenFlag('NP')"></button>
                                            </th>
                                            <th style="width:15rem">Interpretación del nivel de probabilidad</th>
                                            <th>
                                                <a>Nivel de consecuencia (NC)</a>
                                                <button 
                                                pButton type="button"icon="bi bi-question-circle"
                                                    class="p-button-rounded p-button-text"
                                                    pTooltip="Ayuda"
                                                    (click)="imagenFlag('NC')"></button>
                                            </th>
                                            <th>
                                                <a>Nivel de riesgo (NR=NP*NC)</a>
                                                <button 
                                                pButton type="button"icon="bi bi-question-circle"
                                                    class="p-button-rounded p-button-text"
                                                    pTooltip="Ayuda"
                                                    (click)="imagenFlag('NR')"></button>
                                            </th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-nivel  let-editing="editing" let-ri="rowIndex">
                                        <tr [pEditableRow]="nivel">
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output">
                                                    <p-dropdown  required formControlName="ND" appendTo="body" [options]="this.ND" [(ngModel)]="nivel['ND']" [ngModelOptions]="{standalone: true}" (onChange)="nivelProbabilidad('residual')">
                                                    </p-dropdown>
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    <p-dropdown  required formControlName="NE"appendTo="body" [options]="this.NE" [(ngModel)]="nivel['NE']" [ngModelOptions]="{standalone: true}" (onChange)="nivelProbabilidad('residual')">
                                                    </p-dropdown>
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    {{nivel['NP']}}                                                
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    {{nivel['I']}}
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output">
                                                    <p-dropdown  required formControlName="NC" appendTo="body" [options]="this.NC" [(ngModel)]="nivel['NC']" [ngModelOptions]="{standalone: true}" (onChange)="nivelRiesgo('residual')">
                                                    </p-dropdown>
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    {{nivel['NR']}}                                                
                                                </ng-template>
                                            </p-cellEditor></td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                                <br>
                                <p-table [value]="valoracionRI2Residual" [tableStyle]="{ 'min-width': '50rem' }" *ngIf="falgTable">
                                    <ng-template pTemplate="header">
                                        <tr>
                                            <th colspan="3" class="text-center">Interpretación del riesgo</th>
                                        </tr>
                                        <tr>
                                            <th>Cuantitativo</th>
                                            <th>Cualitativo</th>
                                            <th>Acción</th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-nivel  let-editing="editing" let-ri="rowIndex">
                                        <tr [pEditableRow]="nivel">
                                            <td [class]="nivel['color']"><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    <b>{{nivel['CN']}}</b>
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td [class]="nivel['color']"><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    <b>{{nivel['CL']}}</b>
                                                </ng-template>
                                            </p-cellEditor></td>
                                            <td><p-cellEditor>
                                                <ng-template pTemplate="output" >
                                                    <textarea [readonly]="true" [(ngModel)]="nivel['accion']" [ngModelOptions]="{standalone: true}"></textarea>                 
                                                </ng-template>
                                            </p-cellEditor></td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                            </div>
                            <!-- <div class="col-md-12 col-sm-12 gridcol">
                                <label for="">Acción:</label>
                                <textarea [readonly]="true" cols="10" rows="5"  [(ngModel)]="accion" [ngModelOptions]="{standalone: true}"></textarea>
                            </div> -->
                        </div>
                        <br>
                        <h1>Evidencia riesgo residual</h1>
                        <button pButton type="button" (click)="visibleDlgFoto2=true" icon="fa fa-plus" label="Adjuntar evidencia" style="margin-bottom: 10px;" [disabled]="!formMatrizRiesgosIResidual.valid  || CRUDMatriz=='PUT' || formMatrizGeneral.value.Subproceso.length>1"></button>
                        <s-documentoUpload tipoEvidencia="matrizRResidual" [(visible)]="visibleDlgFoto2" [modParam]="idMatriz" [modulo]="modulo" (onUpload)="onUpload($event)" [flagPrivado]="false"></s-documentoUpload>
                        <div *ngFor="let doc of documentosList">
                            <table class="dwrapper" *ngIf="doc.proceso=='matrizRResidual'">
                            <tr>
                                <td>
                                <span [class]="doc.extension?.icono" [style.color]="doc.extension?.color"></span>
                                <a style="margin-left: 10px;" (click)="descargarDocumento(doc)">{{doc.nombre}}</a>
                                </td>
                                <td style="text-align: right;">
                                <a class="bi bi-pencil-square" title="Actualizar Descripción" (click)="actualizarDesc(doc)" *ngIf="!readOnly"></a>
                                <a>&nbsp;</a>
                                <a class="pi pi-trash" title="Eliminar documento" (click)="eliminarDocument(doc)" *ngIf="!readOnly" style="color: red;"></a>
                                </td>
                            </tr>
                            <tr>
                                <td colspan="2">
                                <textarea pInputTextarea [(ngModel)]="doc.descripcion" maxlength="253"></textarea>
                                </td>
                            </tr>
                            </table>
                        </div>
                    </form>
                </div>
            </p-accordionTab>
            <p-accordionTab header="VII. EFECTIVIDAD EN LOS CONTROLES" [disabled]="!(this.tareasList.length>0 || this.tareasListPendiente.length>0 || this.tareasListEjecutado.length>0)">
                <!-- <div [class]="((this.tareasList.length>0 || this.tareasListPendiente.length>0 || this.tareasListEjecutado.length>0) && flagEliminadoSustituido)?'overlay':'overlay-content'"> -->
                <!-- <div [class]="(!formMatrizPeligros.valid || flagEliminadoSustituido)?'overlay-content':'overlay'"> -->

                    <form [formGroup]="formEfectividadControles">

                        <h1>Indicador de gestión</h1>
                        <div class="grid accordionTab">
                            <div class="col-3 col-sm-6 gridcol">
                                <label for="">Controles ejecutados: &nbsp;</label>
                                <input type="text" formControlName="controlEjecutados" readonly>
                                <!-- <span>{{tareasListEjecutadoPorcentaje.length}}</span> -->
                            </div>
                            <div class="col-3 col-sm-6 gridcol">
                                <label for="">Controles propuestos: &nbsp;</label>
                                <input type="text" formControlName="controlPropuestos" readonly>
                                <!-- <span>{{tareasList.length}}</span> -->
                            </div>
                            <div class="col-3 col-sm-6 gridcol">
                                <label for="">Cumplimiento (%): &nbsp;</label>
                                <input type="text" formControlName="cumplimiento" readonly>
                                <!-- <span>{{((tareasListEjecutadoPorcentaje.length*100)/(tareasList.length)).toFixed(2)}}%</span> -->
                            </div>
                        </div>
                        <hr>
                        <h1>Indicador de impacto</h1>
                        <div class="grid accordionTab">
                            <div class="col-12 gridcol">
                                <label for="">Cantidad de EL asociados: &nbsp;</label>
                                <ng-template [sTienePermiso]="'IPECR_PUT_ELASOCIADOS'" (flagTienePermiso)="TienePermiso($event)">
                                </ng-template>
                                <input  type="number" formControlName="ELasociados" [readonly]="!this.permisoFlagELASOCIADOS || flagEliminadoSustituido">
                            </div>
                            <div class="col-12 gridcol">
                                <label for="">Cantidad de AT asociados: &nbsp;</label>
                                <input type="number" formControlName="ATasociados" readonly>&nbsp;
                                <button 
                                        pButton type="button"icon="pi pi-plus"
                                            class="p-button-primary"
                                            pTooltip="Agregar AT"
                                            (click)="reporteATSum()" [disabled]="flagEliminadoSustituido"></button>
                            </div>
                            <div class="col-12">
                                <p-table #dtEf styleClass="material-table" autoLayout="true" selectionMode="single" [value]="ATTable" [paginator]="true" [rows]="10" >
                                    <ng-template pTemplate="header" let-columns>
                                        <tr>
                                            <th>RAI</th>
                                            <th>Fecha de Reporte</th>
                                            <th>Fecha de Accidente</th>
                                            <th>Primer Nombre Empleadp</th>
                                            <th>Primer Apellido Empleado</th>
                                            <th>Numero de Identificaciópn Empleado</th>
                                            <th>Numero Furat</th>
                                            <th>Area de Accidente</th>
                                            <th>&nbsp;</th>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="body" let-at>
                                        <tr class="table-row table-row-selectable">
                                            <td>RAI-{{at.id}}</td>
                                            <td>{{at.fechaReporte | date:'dd/MM/yyyy'}}</td>
                                            <td>{{at.fechaAccidente | date:'dd/MM/yyyy'}}</td>
                                            <td>{{at.primerNombreEmpleado}}</td>
                                            <td>{{at.primerApellidoEmpleado}}</td>
                                            <td>{{at.numeroIdentificacionEmpleado}}</td>
                                            <td>{{at.numerofurat}}</td>
                                            <td>{{at.areaAccidente.nombre}}</td>
                                            <td>
                                                <button  pButton class="flex m-2 p-button-danger p-button-sm" icon="pi pi-trash" (click)="eliminarATTabla(at.id)" [disabled]="flagEliminadoSustituido"></button>
                                            </td>
                                        </tr>
                                    </ng-template>
                                    <ng-template pTemplate="emptymessage">
                                        <tr>
                                            <td [attr.colspan]="9">No hay AT asociados a esta matriz</td>
                                        </tr>
                                    </ng-template>
                                </p-table>
                            </div>
                        </div>
                    </form>
                <!-- </div> -->
            </p-accordionTab>
            <p-accordionTab header="VIII. INDICADOR ICR">
                <label>ICR: </label> &nbsp;
                <span>{{(!flagSustitucion && flagEliminadoSustituido)?(100):(valoracionRI1[0].NR>0 && valoracionRI1Residual[0].NR !=null && valoracionRI1Residual[0].NE !=null && valoracionRI1Residual[0].NC !=null)?(((valoracionRI1[0].NR-valoracionRI1Residual[0].NR)/valoracionRI1[0].NR)*100).toFixed(2):0}}%</span>
            </p-accordionTab>
            
            
        </p-accordion>
        
        <button pButton
        *ngIf="!flagConsulta" 
        (click)="guardarMatriz()"
        type="button"
        [icon]="CRUDMatriz=='PUT'?'pi pi-save':'pi pi-pencil'"
        class="float-btn" 
        [class]="CRUDMatriz=='PUT'?'p-button-primary':'p-button-success'"
        style="bottom: 140px;"
        [title]="CRUDMatriz=='PUT'?'Guardar datos de matriz de peligros':'Modificar datos de matriz de peligros'"
        style="bottom: 70px; z-index: 10000;"
        [disabled]="!(((!flagSustitucion && !formMatrizPeligrosSustitucion.valid) || (flagSustitucion && formMatrizPeligrosSustitucion.valid))) || guardadoSustitucion || !formMatrizGeneral.valid"
        ></button>

        <button pButton 
        *ngIf="!flagConsulta && CRUDMatriz != 'PUT'"
        (click)="nuevoPeligroEnSubprocesoActual();"
        type="button"
        [icon]="'pi pi-clone'"
        class="float-btn"
        style="bottom: 150px; z-index: 10000;"
        [title]="'Esta acción evaluará  un nuevo peligro a partir de la información general - descripción actual, asegúrese de guardar antes de continuar.'"
        ></button>
    </p-panel>
</ng-container>
<br>
<ng-container *ngIf="flagSustitucion">
    <p-panel>
        <ng-template pTemplate="header"><div style="display: flex; justify-content: space-between; width: 100%;"><h1><b>MATRIZ DE PELIGROS (Sustitución)</b></h1></div></ng-template>

        <h1>II. IDENTIFICACIÓN DEL PELIGRO</h1>

        <div [class]="(flagidPadre)?'overlay-content':'overlay'">
            <form [formGroup]="formMatrizPeligrosSustitucion">
                <div class="grid accordionTab">
                    <div class="col-md-6 col-sm-12 gridcol">
                        <label for="">Clasificación</label>
                        <p-dropdown  [filter]="true" required [options]="this.tipoPeligroItemList" formControlName="Peligro" (onChange)="SelectPeligro($event.value,'sustituto')" >
                        </p-dropdown>
                    </div>
                    <br>
                    <div class="col-md-6 col-sm-12 gridcol">
                        <label for="">Descripción del peligro</label>
                        <p-dropdown  [filter]="true" [options]="this.peligroItemList2" formControlName="DescripcionPeligro" (onChange)="SelectEfecto($event.value,'sustituto')" required></p-dropdown>
                    </div>
                    <br>
                    <div class="col-md-12 col-sm-12 gridcol">
                        <label for="">Posibles consecuencias/efectos a la salud.</label>
                        <textarea [readonly]="true" cols="10" rows="3" formControlName="Efectos"></textarea>
                    </div>
                    <br>
                    <div class="col-md-12 col-sm-12 gridcol">
                        <label for="">Fuente generadora</label>
                        <textarea cols="10" rows="3" formControlName="FuenteGeneradora" required></textarea>
                    </div>                   
                </div>
            </form>
        </div>
    </p-panel>
</ng-container>     


<p-dialog [(visible)]="imgFlag" modal="true" [contentStyle]="{'max-height':'70%'}" [style]="{width:'80%'}" [header]="imgNameHeader">
    <div style="margin: auto;"><img [src]="'../../../../../../assets/png/matriz-peligros/'+this.imgName" alt="" style=" width: 100%"></div>
</p-dialog>

<p-dialog [(visible)]="putAreaTree" modal="true" [style]="{width:'80%'}">
    <div *ngIf="CRUDarea=='POST'">
        <label for="">Agregar nueva área:</label><br>
        <input type="text" [(ngModel)]="newArea">
    </div>
    <div *ngIf="CRUDarea=='PUT'">
        <label for="">Editar área:</label><br>
        <input type="text" [(ngModel)]="newArea">
    </div>
    <br>
    <div *ngIf="CRUDarea=='POST'">
        <button pButton type="button" 
        icon="bi bi-plus"
        class="p-button-raised p-button-primary"
        label="Agregar"
        pTooltip="Agregar área"
        (click)="CRUDArea('POST')"
        ></button>
    </div>
    <div *ngIf="CRUDarea=='PUT'">
        <button pButton type="button" 
        icon="bi bi-pencil"
        class="p-button-success"
        label="Editar"
        (click)="CRUDArea('PUT')"
        ></button>
    </div>
</p-dialog>

<p-dialog [(visible)]="putProcesoTree" modal="true" [style]="{width:'80%'}">
    <div *ngIf="CRUDproceso=='POST'">
        <label for="">Agregar nuevo proceso al área {{this.nombreAreaTree}}:</label><br>
        <input type="text" [(ngModel)]="newProceso">
    </div>
    <div *ngIf="CRUDproceso=='PUT'">
        <label for="">Editar proceso:</label><br>
        <input type="text" [(ngModel)]="newProceso">
    </div>
    <br>
    <div *ngIf="CRUDproceso=='POST'">
        <button pButton type="button" 
        icon="bi bi-plus"
        class="p-button-raised p-button-primary"
        label="Agregar"
        (click)="CRUDProceso('POST')"
        ></button>
    </div>
    <div *ngIf="CRUDproceso=='PUT'">
        <button pButton type="button" 
        icon="bi bi-pencil"
        class="p-button-success"
        label="Editar"
        (click)="CRUDProceso('PUT')"
        ></button>
    </div>
</p-dialog>

<p-dialog [(visible)]="putSubprocesoTree" modal="true" [style]="{width:'80%', heigh:'50%'}">
    <div *ngIf="CRUDsubproceso=='POST'">
        <label for="">Agregar nuevo subproceso (cargo/oficio) al proceso {{this.nombreProcesoTree}}:</label><br>
        <div>
            <p-dropdown [filter]="true" [options]="cargoList" [(ngModel)]="newSubproceso" appendTo="body"
                class="select-material" styleClass="select-material">
            </p-dropdown>
        </div>
        
    </div>
    
    <br>
    <div *ngIf="CRUDsubproceso=='POST'">
        <button pButton type="button" 
        icon="bi bi-plus"
        class="p-button-raised p-button-primary"
        label="Agregar"
        title="Agregar subproceso (cargo/oficio)"
        (click)="CRUDSubproceso('POST')"
        ></button>
    </div>
    
</p-dialog>


<!-- Plan accion -->
<p-dialog [(visible)]="flagPlanAccion" modal="true" [style]= "{'width': '80%'}">
    <form [formGroup]="formPlanAccion">
        <div class="grid">
            <div class="col-12">
                <span>Jerarquía de control</span><br>
                <p-dropdown  required formControlName="jerarquia" appendTo="body" [options]="jControl">
                </p-dropdown>
            </div>
            <div class="col-12">
                <span>Descripción</span> <br>
                <textarea required name="descripcion"  formControlName="descripcion" cols="10" rows="3"></textarea>
            </div>
            <div class="col-12">
                <span>Tipo de barrera:</span> <br>
                <div style="display: flex;">
                    <p-radioButton required name="barreras" label="Barrera dura" [value]="'Barrera dura'"  [style]="{'margin-left': '15px'}" formControlName="barreras"></p-radioButton>
                    <p-radioButton name="barreras" label="Barrera blanda" [value]="'Barrera blanda'" [style]="{'margin-left': '15px'}"  formControlName="barreras"></p-radioButton>
                </div>
            </div>
            <div class="col-12">
                <span>Estado del plan de acción</span> <br>
                <p-dropdown  required formControlName="estado" appendTo="body" [options]="estadosPlanAccion">
                </p-dropdown>
            </div>
            <div class="col-12">
                <div *ngIf="CRUDplanAccion=='POST'">
                    <button pButton type="button" 
                    [disabled]="!formPlanAccion.valid"
                    icon="bi bi-plus"
                    class="p-button-primary"
                    label="Agregar"
                    title="Agregar plan de acción"
                    (click)="planAccionCRUD('POST')"
                    ></button>
                </div>
                <div *ngIf="CRUDplanAccion=='PUT'">
                    <button pButton type="button" 
                    [disabled]="!formPlanAccion.valid"
                    icon="bi bi-pencil"
                    class="p-button-success"
                    label="Editar"
                    title="Editar plan de acción"
                    (click)="planAccionCRUD('PUT')"
                    ></button>
                </div>
            </div>
        </div>
    </form>
</p-dialog>

<!--Riesgo existente -->
<p-dialog [(visible)]="controlFlag" modal="true" [style]= "{'width': '80%'}">
    <form [formGroup]="formControl">
        <div class="grid">
            <div class="col-12">
                <span>Jerarquía de control:</span><br>
                <!-- <span>{{jerarquiaExistente}}</span> -->
                <input pInputText type="text" style="width:100%" [value]="jerarquiaExistente" readonly="true">
                <!-- <div>Control Ingenieria</div> -->
            </div>
            <div class="col-12">
                <span>Descripción:</span> <br>
                <textarea required name="descripcion"  formControlName="descripcion" cols="10" rows="3"></textarea>
            </div>
            <div class="col-12">
                <span>Tipo de barrera:</span> <br>
                <div style="display: flex;">
                    <p-radioButton required name="barrera" label="Barrera dura" [value]="'Barrera dura'"  [style]="{'margin-left': '15px'}" formControlName="barrera"></p-radioButton>
                    <p-radioButton name="barrera" label="Barrera blanda" [value]="'Barrera blanda'" [style]="{'margin-left': '15px'}"  formControlName="barrera"></p-radioButton>
                </div>
            </div>
            <div class="col-12">
                <div *ngIf="CRUDcontrol=='POST'">
                    <button pButton type="button" 
                    [disabled]="!formControl.valid"
                    icon="bi bi-plus"
                    class="p-button-primary"
                    label="Agregar"
                    title="Agregar control existente"
                    (click)="controlCRUD('POST')"
                    ></button>
                </div>
                <div *ngIf="CRUDcontrol=='PUT'">
                    <button pButton type="button" 
                    [disabled]="!formControl.valid"
                    icon="bi bi-pencil"
                    class="p-button-success"
                    label="Editar"
                    title="Editar control existente"
                    (click)="controlCRUD('PUT')"
                    ></button>
                </div>
            </div>
        </div>
    </form>
</p-dialog>
<p-dialog header="AGREGAR AT A LA MATRIZ DE PELIGROS" [(visible)]="flagATasociados" modal="true" [style]= "{'width': '80%'}">
    <p-toast  key="mpeligrosDialog"></p-toast>

    <div class="grid">
        <div class="col-12">
            <span>Escriba el RAI para asociar el accidente a la matriz</span><br>
        </div>
        <div class="col-12">
            <p-autoComplete placeholder="Buscar por numero RAI" [style]="{'width':'100%'}"
            (onSelect)="onSelectionAT($event)" [suggestions]="ATList" (completeMethod)="buscarRAI($event)" appendTo="body" [(ngModel)]="ATSelect">
                <ng-template let-at pTemplate="item">
                    <div class="ui-helper-clearfix" >
                        <div class="wrapper" >
                            <div style="margin-left:20px">
                                <label>RAI-{{at.id}}</label>
                            </div>
                        </div>
                    </div>
                </ng-template>
            </p-autoComplete>
        </div>
        <div class="col-12">
            <p-table #dtEfDial styleClass="material-table" autoLayout="true" selectionMode="single" [value]="ATTableDialog" [paginator]="true" [rows]="10" >
                <ng-template pTemplate="header" let-columns>
                    <tr>
                        <th>RAI</th>
                        <th>Fecha de Reporte</th>
                        <th>Fecha de Accidente</th>
                        <th>Primer Nombre Empleadp</th>
                        <th>Primer Apellido Empleado</th>
                        <th>Numero de Identificaciópn Empleado</th>
                        <th>Numero Furat</th>
                        <th>Area de Accidente</th>
                        <th>&nbsp;</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-at>
                    <tr class="table-row table-row-selectable">
                        <td>RAI-{{at.id}}</td>
                        <td>{{at.fechaReporte | date:'dd/MM/yyyy'}}</td>
                        <td>{{at.fechaAccidente | date:'dd/MM/yyyy'}}</td>
                        <td>{{at.primerNombreEmpleado}}</td>
                        <td>{{at.primerApellidoEmpleado}}</td>
                        <td>{{at.numeroIdentificacionEmpleado}}</td>
                        <td>{{at.numerofurat}}</td>
                        <td>{{at.areaAccidente.nombre}}</td>
                        <td>
                            <button  pButton class="flex m-2 p-button-danger p-button-sm" icon="pi pi-trash" (click)="eliminarATTablaDialog(at.id)"></button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="summary" let-rowData>
                    <tr>
                        <td colspan="4">
                            <div class="flex justify-content-end flex-wrap">
                                <button  pButton class="flex m-2 p-button-primary p-button-sm" label="Asociar" icon="pi pi-plus" (click)="asociarATTablaDialog()" [disabled]="ATTableDialog.length==0"></button>
                            </div>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td [attr.colspan]="9">No hay AT asociados a esta matriz</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>

</p-dialog>
