<p-toast key="formScmSL"></p-toast>
<!-- <p-messages [(value)]="msgs" ></p-messages> -->
<p-confirmDialog></p-confirmDialog>

<p-tabView>
  <p-tabPanel header="Información General" *sTienePermiso="'SCM_GET_ICSL'">
    <app-datos-trabajador-involucrado></app-datos-trabajador-involucrado>
    <br />
    <p-panel header="Datos del jefe inmediato">
      <form [formGroup]="jefeInmediato">
        <div class="container-fluid cew-9">
          <!-- <div class="row">
                        <div>
                            <h5 class="title-header p-mb-2">Datos del jefe inmediato</h5>
                        </div>
                    </div> -->
          <!-- div -->
          <div class="row">
            <div class="col">
              <div>
                <div>
                  <label for="" class="active">Número de identificación</label>
                </div>
                <div>
                  <p-autoComplete
                    [readonly]="consultar2"
                    styleClass="form-control-autocomplete"
                    placeholder="Digite"
                    [style]="{ width: '100%' }"
                    (onSelect)="onSelectionJefeInmediato($event)"
                    [suggestions]="empleadosList"
                    (completeMethod)="buscarEmpleado($event)"
                    formControlName="numeroIdentificacion"
                    *ngIf="empleado?.id == null"
                  >
                    <ng-template let-empleado pTemplate="item">
                      <div class="ui-helper-clearfix">
                        <div class="wrapper">
                          <i
                            *ngIf="!empleado.usuario?.icon"
                            class="fa fa-user-circle"
                            style="font-size: 48px"
                            aria-hidden="true"
                          ></i>
                          <img
                            *ngIf="empleado.usuario?.icon"
                            [src]="empleado.usuario?.icon"
                            style="border-radius: 50%"
                            #imgAvatar
                          />
                          <div style="margin-left: 20px">
                            <br />{{ empleado?.primerApellido }}
                            {{ empleado?.primerNombre }}
                            {{ empleado?.segundoNombre }}

                            <br />
                            {{ empleado?.numeroIdentificacion }} <br />
                            {{ empleado?.usuario.email }}
                          </div>
                        </div>
                      </div>
                    </ng-template>
                  </p-autoComplete>
                </div>
              </div>
            </div>
            <div class="col">
              <div>
                <label for="" class="active">Apellidos y nombres</label>
                <input
                  type="text"
                  pInputText
                  [value]="jefeNames"
                  placeholder="Apellidos y nombres"
                  [attr.disabled]="true"
                  class="form-control"
                  id="jefeNames"
                />
              </div>
            </div>

            <div class="col">
              <div>
                <div>
                  <label for="" class="active">Cargo / Categoría</label>
                </div>
                <div>
                  <p-dropdown
                    [filter]="true"
                    [options]="cargoList"
                    formControlName="cargoId"
                    class="select-material"
                    styleClass="select-material"
                  >
                  </p-dropdown>
                </div>
              </div>
            </div>
            <div class="col">
              <div>
                <label for="" class="active">Número móvil corporativo</label>
                <input
                  type="text"
                  pInputText
                  formControlName="corporativePhone"
                  class="form-control"
                  styleClass="form-control"
                />
              </div>
            </div>
          </div>
        </div>
        <div class="col-3">
          <div>
            <label for="" class="active">Correo corporativo</label>
            <input
              type="text"
              pInputText
              formControlName="email"
              placeholder="Correo corporativo"
              class="form-control"
              id="emailjefe"
            />
          </div>
        </div>
      </form>
    </p-panel>
    <br />
    <p-panel header="Datos de la empresa">
      <form [formGroup]="empresaForm">
        <div class="row">
          <div class="col">
            <label for="" class="active">Nombre Comercial</label>
            <p-dropdown
              appendTo="body"
              [options]="empresaList2"
              optionLabel="label"
              formControlName="empresa"
              [(ngModel)]="empresaSelect2"
              class="select-material"
              styleClass="select-material"
            >
            </p-dropdown>
          </div>
          <div class="col">
            <label for="nit" class="active">Nit</label>
            <input
              type="text"
              id="nit"
              class="form-control"
              pInputText
              optionLabel="nit"
              formControlName="nit"
              [value]="empresaSelect2?.nit"
              readonly="true"
            />
          </div>
        </div>
      </form>
    </p-panel>
  </p-tabPanel>
  <ng-container *ngIf="empleadoSelect || consultar">
    <p-tabPanel
      header="Casos de Salud laboral"
      *ngIf="!flagSaludLaboralRegistro"
    >
      <p-table
        *ngIf="!caseSelect && !createCase"
        #dt
        styleClass="material-table"
        [value]="saludlaboralCHANGETest"
        autoLayout="true"
        selectionMode="single"
        [loading]="loading"
        [(selection)]="saludLaboralSelect"
        [rows]="10"
        [paginator]="true"
        dataKey="idSl"
        [lazy]="true"
        (onLazyLoad)="lazyLoad($event)"
        [totalRecords]="totalRecords"
        (onFilter)="onFilter($event)"
      >
        <ng-template pTemplate="header">
          <tr>
            <th pSortableColumn="idSl">No.</th>
            <th pSortableColumn="fechaCreacion">Fecha de creación</th>

            <th pSortableColumn="usuarioCreador">Correo Electronico</th>
            <th pSortableColumn="usuarioAsignado">Nombre</th>
            <th pSortableColumn="idSl">No. Documento</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-case>
          <tr [pSelectableRow]="case" class="table-row table-row-selectable">
            <td>{{ case.idSl }}</td>
            <td>{{ case.fechaCreacion | date : "dd/MM/yyyy" }}</td>
            <td>{{ case.usuarioCreador }}</td>
            <td>{{ case.nombreCompletoSL }}</td>
            <td>{{ case.usuarioAsignado }}</td>
          </tr>
        </ng-template>
        <ng-template pTemplate="summary" let-rowData>
          <button
            pButton
            *sTienePermiso="'SCM_POST_CSL'"
            type="button"
            (click)="createCaso()"
            icon="bi bi-plus"
            class="p-button-raised p-button-primary margin-right"
            label="Crear Caso"
          ></button>

          <button
            pButton
            *sTienePermiso="'SCM_PUT_CSL'"
            type="button"
            label="Modificar"
            icon="bi bi-pencil"
            class="p-button-raised p-button-success margin-right margin-left"
            (click)="openCase()"
            [disabled]="!saludLaboralSelect"
          ></button>

          <button
            pButton
            *sTienePermiso="'SCM_GET_CSL'"
            type="button"
            icon="bi bi-eye"
            label="Consultar"
            class="p-button-info margin-left margin-right"
            (click)="openCaseConsultar()"
            [disabled]="!saludLaboralSelect"
          ></button>
        </ng-template>
        <ng-template pTemplate="emptymessage">
          <tr>
            <td colspan="5" class="p-text-center">
              No hay casos de salud laboral registrados.
            </td>
          </tr>
        </ng-template>
      </p-table>
    </p-tabPanel>
    <ng-container *sTienePermiso="'SCM_GET_DCSL'">
      <p-tabPanel *ngIf="flagSaludLaboralRegistro" header="Diagnósticos">
        <div class="container-fluid cew-9">
          <div class="row">
            <h2 class="title-header p-mb-2">Información sobre diagnósticos</h2>
          </div>
          <div class="ui-g-12">
            <p-table
              #dt
              [value]="diagnosticoList"
              styleClass="material-table"
              autoLayout="true"
              selectionMode="single"
              [(selection)]="diagSelect"
              [rows]="5"
              [paginator]="true"
              dataKey="id"
              [lazy]="true"
            >
              <ng-template pTemplate="header">
                <tr>
                  <th pSortableColumn="codigoCie10">CIE 10</th>
                  <th pSortableColumn="sistemaAfectado">Sistema Afectado</th>
                  <th pSortableColumn="diagnostico">Diagnóstico</th>
                  <th pSortableColumn="detalle">Detalles</th>

                  <th pSortableColumn="fechaDiagnostico">Fecha</th>
                </tr>
              </ng-template>
              <ng-template pTemplate="body" let-case>
                <tr
                  [pSelectableRowDisabled]="modalDianostico"
                  [pSelectableRow]="case"
                  class="table-row table-row-selectable"
                >
                  <td class="p-text-center">{{ case.codigoCie10 }}</td>
                  <td class="p-text-center">
                    {{ case.sistemaAfectado || "" }}
                  </td>
                  <td class="p-text-center">{{ case.diagnostico }}</td>
                  <td class="p-text-center">{{ case.detalle }}</td>
                  <td class="p-text-center">
                    {{ case.fechaDiagnostico | date : "dd/MM/yyyy" }}
                  </td>
                </tr>
              </ng-template>
              <ng-template pTemplate="summary" let-rowData>
                <ng-container>
                  <button
                    pButton
                    [disabled]="diagSelect"
                    type="button"
                    icon="bi bi-plus"
                    label="Crear"
                    class="p-button-raised p-button-primary margin-right"
                    (click)="diagSelect = null; modalDianostico = true"
                  ></button>
                  <button
                    pButton
                    type="button"
                    icon="bi bi-pencil"
                    label="Modificar"
                    class="p-button-raised p-button-success margin-right margin-left"
                    (click)="showModalDiagnostico()"
                    [disabled]="!diagSelect"
                  ></button>
                  <button
                    pButton
                    type="button"
                    icon="bi bi-trash"
                    label="Eliminar"
                    class="p-button-raised p-button-danger margin-right margin-left"
                    [disabled]="!diagSelect"
                    (click)="deleteDiagnostico(diagSelect.id)"
                  ></button>
                  <!-- <button pButton type="button" icon="bi bi-search" label="Consultar"
                                      class="p-button-raised p-button-warning margin-right margin-left"
                                      [disabled]="!diagSelect" (click)="showModalDiagnosticoConsulta()"></button> -->
                </ng-container>

                <!-- <ng-container><button *sTienePermiso="'SCM_PUT_CASE_DIAG'" pButton
                                      type="button" icon="bi bi-search" label="Consultar" class="p-button-warning"
                                      (click)="showModalDiagnosticoConsulta()"
                                      [disabled]="!diagSelect"></button></ng-container> -->
              </ng-template>
              <ng-template pTemplate="emptymessage">
                <tr>
                  <td colspan="6" class="p-text-center">
                    No hay registro de diagnósticos médicos
                  </td>
                </tr>
              </ng-template>
            </p-table>
          </div>
        </div>
      </p-tabPanel>
    </ng-container>

    <ng-container *sTienePermiso="'SCM_GET_LCPCLSL'">
      <p-tabPanel
        header="Calificación (origen -PCL)"
        *ngIf="saludLaboralSelect && this.diagnosticoList.length > 0"
      >
        <app-pcl
          [diagnosticos]="this.diagnosticoList"
          [entity]="entity"
          [emitPclentity]="emitPclentity"
          [saludLaboralFlag]="true"
          [pkCase]="saludLaboralSelect.idSl"
          [pclOptionList]="pclOptionList"
          (eventClose)="onCloseModalDianostico()"
          (dlistaPCL)="recibirPCL($event)"
        >
        </app-pcl>
      </p-tabPanel>
    </ng-container>
    <ng-container *sTienePermiso="'SCM_POST_SDCSL'">
      <p-tabPanel *ngIf="flagSaludLaboralRegistro" header="Documentación">
        <p-accordion [multiple]="true">
          <form [formGroup]="empleadoForm" (ngSubmit)="onSubmit()">
            <!-- Otros campos del formulario -->

            <p-accordionTab
              header="Fecha recepción de solicitud de documentación"
            >
              <div class="form-row mt-3">
                <div class="col-12">
                  <label for="fechaLimite"
                    >Fecha recepción de solicitud de documentación:</label
                  >
                  <p-calendar
                    id="fechaLimite"
                    appendTo="body"
                    [monthNavigator]="true"
                    [yearNavigator]="true"
                    [yearRange]="yearRange"
                    [maxDate]="fechaActual"
                    formControlName="fechaRecepcionDocs"
                    dateFormat="dd/mm/yy"
                  ></p-calendar>
                </div>
                <div class="col">
                  <div class="input-field">
                    <label for="" class="active"
                      >Entidad que solicita la documentación</label
                    >
                    <p-dropdown
                      appendTo="body"
                      [filter]="true"
                      [options]="emitPclentity"
                      formControlName="entidadEmiteCalificacion"
                      class="select-material"
                      styleClass="select-material"
                      [readonly]="action"
                      (onChange)="onEntidadChange($event)"
                    >
                    </p-dropdown>
                  </div>
                </div>

                <!-- Campo de texto para "Otros" -->
                <div class="col" *ngIf="selectedEntidad === 'otros'">
                  <div class="input-field">
                    <label for="" class="active"
                      >Escriba la entidad que solicito la documentación</label
                    >
                    <input
                      type="text"
                      formControlName="otroDetalle"
                      class="form-control"
                    />
                  </div>
                </div>

                <!-- Dropdown para detalles -->
                <div class="col" *ngIf="isDetalleEnabled">
                  <div class="input-field">
                    <label for="" class="active">Entidad</label>
                    <p-dropdown
                      appendTo="body"
                      [filter]="true"
                      [options]="detalleOptions"
                      formControlName="detalleCalificacion"
                      class="select-material"
                      styleClass="select-material"
                    >
                    </p-dropdown>
                  </div>
                </div>
                <div class="col-12">
                  <label for="fechaLimite"
                    >Fecha maxima de envio para solicitud de
                    documentación:</label
                  >
                  <p-calendar
                    id="fechaLimite"
                    appendTo="body"
                    [monthNavigator]="true"
                    [yearNavigator]="true"
                    [yearRange]="yearRange"
                    [maxDate]="fechaActual"
                    formControlName="fechaMaximaEnvDocs"
                    dateFormat="dd/mm/yy"
                  ></p-calendar>
                </div>
              </div>
            </p-accordionTab>
          </form>

          <p-accordionTab header="GH Admon personal">
            <div *ngIf="flag1" class="container-fluid">
              <div class="form-row">
                <div class="col-12">
                  <label for="responsable">Responsable:</label>
                  <p-autoComplete
                    id="responsable"
                    styleClass="form-control-autocomplete"
                    placeholder="Digite"
                    [style]="{ width: '100%' }"
                    [suggestions]="empleadosList"
                    (completeMethod)="buscarEmpleado($event)"
                    (onSelect)="selectResonsable($event, 'res1')"
                    [(ngModel)]="usuarioSolicitado"
                  >
                    <ng-template let-empleado pTemplate="item">
                      <div class="ui-helper-clearfix">
                        <div class="wrapper">
                          <div class="empleado-info">
                            <br />
                            {{ empleado?.primerApellido }}
                            {{ empleado?.primerNombre }}
                            {{ empleado?.segundoNombre }}
                            <br />
                            {{ empleado?.numeroIdentificacion }}
                            <br />
                            {{ empleado?.usuario.email }}
                          </div>
                        </div>
                      </div>
                    </ng-template>
                  </p-autoComplete>
                </div>
              </div>
              <div class="form-row mt-3">
                <div class="col-12">
                  <label for="tipoDocumento"
                    >Tipo de documento a solicitar:</label
                  >
                  <p-dropdown
                    id="tipoDocumento"
                    [options]="doc"
                    [(ngModel)]="selectedDoc"
                    required
                    styleClass="select-material"
                  ></p-dropdown>
                </div>
              </div>
              <div class="form-row mt-3">
                <div class="col-12">
                  <label for="fechaLimite"
                    >Fecha límite envío de documentación:</label
                  >
                  <p-calendar
                    id="fechaLimite"
                    appendTo="body"
                    [monthNavigator]="true"
                    [yearNavigator]="true"
                    [yearRange]="yearRange"
                    [maxDate]="fechaActual"
                    [formControl]="formulario.get('fechaLimite')"
                    dateFormat="dd/mm/yy"
                  ></p-calendar>
                </div>
              </div>
              <div class="form-row mt-3">
                <div class="col-12">
                  <button
                    class="btn btn-primary"
                    (click)="addEmailSendghAdmon()"
                  >
                    <i class="fas fa-save"></i> Guardar selección
                  </button>
                </div>
              </div>
              <div class="form-row mt-4">
                <div class="col-12">
                  <h5>Correos para enviar:</h5>
                  <div
                    *ngFor="let item of ghAdmonPersonal; let i = index"
                    class="form-group saved-item"
                  >
                    <div class="saved-item-content">
                      <label>Responsable:</label>
                      <p-autoComplete
                        styleClass="form-control-autocomplete"
                        placeholder="Digite"
                        [style]="{ width: '100%' }"
                        [suggestions]="empleadosList"
                        (onSelect)="
                          selectResonsableSelected($event, 'res1', item)
                        "
                        (completeMethod)="buscarEmpleado($event)"
                        [(ngModel)]="item.usuarioSolicitado"
                      >
                        <ng-template let-empleado pTemplate="item">
                          <div class="ui-helper-clearfix">
                            <div class="wrapper">
                              <div class="empleado-info">
                                <br />
                                {{ empleado?.primerApellido }}
                                {{ empleado?.primerNombre }}
                                {{ empleado?.segundoNombre }}
                                <br />
                                {{ empleado?.numeroIdentificacion }}
                                <br />
                                {{ empleado?.usuario.email }}
                              </div>
                            </div>
                          </div>
                        </ng-template>
                      </p-autoComplete>
                      <label>Tipo de documento a solicitar:</label>
                      <p-dropdown
                        [options]="doc"
                        [(ngModel)]="item.docSolicitado"
                        styleClass="select-material"
                        required
                      ></p-dropdown>
                      <label>Fecha límite envío de documentación:</label>
                      <p-calendar
                        appendTo="body"
                        [monthNavigator]="true"
                        [yearNavigator]="true"
                        [yearRange]="yearRange"
                        [maxDate]="fechaActual"
                        [(ngModel)]="item.fechaLimite"
                        dateFormat="dd/mm/yy"
                      ></p-calendar>
                      <div>
                        <button
                          class="btn btn-danger btn-sm mt-2"
                          (click)="removeEmail(i)"
                        >
                          <i class="fas fa-times"></i> Eliminar
                        </button>
                      </div>
                    </div>
                    <hr class="divider" />
                  </div>
                </div>
              </div>
            </div>
          </p-accordionTab>

          <p-accordionTab header="Seguridad">
            <div class="container-fluid cew-9 grid">
              <div *ngIf="flag2" class="container-fluid">
                <div class="form-row">
                  <div class="col-12">
                    <label for="responsableSeguridad">Responsable:</label>
                    <p-autoComplete
                      id="responsableSeguridad"
                      styleClass="form-control-autocomplete"
                      placeholder="Digite"
                      [style]="{ width: '100%' }"
                      [suggestions]="empleadoListSegu"
                      (completeMethod)="buscarEmpleado2($event)"
                      (onSelect)="selectResonsable($event, 'res2')"
                      [(ngModel)]="usuarioSolicitadoSeg"
                    >
                      <ng-template let-empleado pTemplate="item">
                        <div class="ui-helper-clearfix">
                          <div class="wrapper">
                            <div class="empleado-info">
                              <br />
                              {{ empleado?.primerApellido }}
                              {{ empleado?.primerNombre }}
                              {{ empleado?.segundoNombre }}
                              <br />
                              {{ empleado?.numeroIdentificacion }}
                              <br />
                              {{ empleado?.usuario.email }}
                            </div>
                          </div>
                        </div>
                      </ng-template>
                    </p-autoComplete>
                  </div>
                </div>
                <div class="form-row mt-3">
                  <div class="col-12">
                    <label for="tipoDocumentoSeguridad"
                      >Tipo de documento a solicitar:</label
                    >
                    <p-dropdown
                      id="tipoDocumentoSeguridad"
                      [options]="docSalud"
                      [(ngModel)]="selectedDocSalud"
                      required
                      styleClass="select-material"
                    ></p-dropdown>
                  </div>
                </div>
                <div class="form-row mt-3">
                  <div class="col-12">
                    <label for="fechaLimiteSeguridad"
                      >Fecha límite envío de documentación:</label
                    >
                    <p-calendar
                      id="fechaLimiteSeguridad"
                      appendTo="body"
                      [monthNavigator]="true"
                      [yearNavigator]="true"
                      [yearRange]="yearRange"
                      [maxDate]="fechaActual"
                      [formControl]="formulario.get('fechaLimite')"
                      dateFormat="dd/mm/yy"
                    ></p-calendar>
                  </div>
                </div>
                <div class="form-row mt-3">
                  <div class="col-12">
                    <button
                      class="btn btn-primary"
                      (click)="addEmailSeguridad()"
                    >
                      <i class="fas fa-save"></i> Guardar selección
                    </button>
                  </div>
                </div>
                <div class="form-row mt-4">
                  <div class="col-12">
                    <h5>Correos para enviar:</h5>
                    <div
                      *ngFor="let item of seguridad"
                      class="form-group saved-item"
                    >
                      <div class="saved-item-content">
                        <label>Responsable:</label>
                        <p-autoComplete
                          styleClass="form-control-autocomplete"
                          placeholder="Digite"
                          [style]="{ width: '100%' }"
                          [suggestions]="empleadoListSegu"
                          (onSelect)="
                            selectResonsableSelectedSeg($event, 'res2', item)
                          "
                          (completeMethod)="buscarEmpleado2($event)"
                          [(ngModel)]="item.usuarioSolicitado"
                        >
                          <ng-template let-empleado pTemplate="item">
                            <div class="ui-helper-clearfix">
                              <div class="wrapper">
                                <div class="empleado-info">
                                  <br />
                                  {{ empleado?.primerApellido }}
                                  {{ empleado?.primerNombre }}
                                  {{ empleado?.segundoNombre }}
                                  <br />
                                  {{ empleado?.numeroIdentificacion }}
                                  <br />
                                  {{ empleado?.usuario.email }}
                                </div>
                              </div>
                            </div>
                          </ng-template>
                        </p-autoComplete>
                        <label>Tipo de documento a solicitar:</label>
                        <p-dropdown
                          [options]="docSalud"
                          [(ngModel)]="item.docSolicitado"
                          required
                          styleClass="select-material"
                        ></p-dropdown>
                        <label>Fecha límite envío de documentación:</label>
                        <p-calendar
                          appendTo="body"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="yearRange"
                          [maxDate]="fechaActual"
                          [(ngModel)]="item.fechaLimite"
                          dateFormat="dd/mm/yy"
                        ></p-calendar>
                        <div>
                          <button
                            class="btn btn-danger btn-sm mt-2"
                            (click)="removeEmailSeg(i)"
                          >
                            <i class="fas fa-times"></i> Eliminar
                          </button>
                        </div>
                      </div>
                      <hr class="divider" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </p-accordionTab>
          <p-accordionTab header="Salud">
            <div class="container-fluid cew-9 grid">
              <div *ngIf="flag3" class="container-fluid">
                <div class="form-row">
                  <div class="col-12">
                    <label for="responsableSalud">Responsable:</label>
                    <p-autoComplete
                      id="responsableSalud"
                      styleClass="form-control-autocomplete"
                      placeholder="Digite"
                      [style]="{ width: '100%' }"
                      [suggestions]="empleadoListSalud"
                      (completeMethod)="buscarEmpleadoSalud($event)"
                      (onSelect)="selectResonsable($event, 'res3')"
                      [(ngModel)]="iduarioSolicitadoSalud"
                    >
                      <ng-template let-empleado pTemplate="item">
                        <div class="ui-helper-clearfix">
                          <div class="wrapper">
                            <div class="empleado-info">
                              <br />
                              {{ empleado?.primerApellido }}
                              {{ empleado?.primerNombre }}
                              {{ empleado?.segundoNombre }}
                              <br />
                              {{ empleado?.numeroIdentificacion }}
                              <br />
                              {{ empleado?.usuario.email }}
                            </div>
                          </div>
                        </div>
                      </ng-template>
                    </p-autoComplete>
                  </div>
                </div>
                <div class="form-row mt-3">
                  <div class="col-12">
                    <label for="tipoDocumentoSalud"
                      >Tipo de documento a solicitar:</label
                    >
                    <p-dropdown
                      id="tipoDocumentoSaludLaboral"
                      [options]="docSaludLaboral"
                      [(ngModel)]="selectedDocSaludLaboral"
                      required
                      styleClass="select-material"
                    ></p-dropdown>
                  </div>
                </div>
                <div class="form-row mt-3">
                  <div class="col-12">
                    <label for="fechaLimiteSeguridad"
                      >Fecha límite envío de documentación:</label
                    >
                    <p-calendar
                      id="fechaLimiteSeguridad"
                      appendTo="body"
                      [monthNavigator]="true"
                      [yearNavigator]="true"
                      [yearRange]="yearRange"
                      [maxDate]="fechaActual"
                      [formControl]="formulario.get('fechaLimite')"
                      dateFormat="dd/mm/yy"
                    ></p-calendar>
                  </div>
                </div>
                <div class="form-row mt-3">
                  <div class="col-12">
                    <button class="btn btn-primary" (click)="addEmailSalud()">
                      <i class="fas fa-save"></i> Guardar selección
                    </button>
                  </div>
                </div>
                <div class="form-row mt-4">
                  <div class="col-12">
                    <h5>Correos para enviar:</h5>
                    <div
                      *ngFor="let item of saludLaboralMail"
                      class="form-group saved-item"
                    >
                      <div class="saved-item-content">
                        <label>Responsable:</label>
                        <p-autoComplete
                          styleClass="form-control-autocomplete"
                          placeholder="Digite"
                          [style]="{ width: '100%' }"
                          [suggestions]="empleadoListSalud"
                          (onSelect)="
                            selectResonsableSelectedSalud($event, 'res3', item)
                          "
                          (completeMethod)="buscarEmpleadoSalud($event)"
                          [(ngModel)]="item.usuarioSolicitado"
                        >
                          <ng-template let-empleado pTemplate="item">
                            <div class="ui-helper-clearfix">
                              <div class="wrapper">
                                <div class="empleado-info">
                                  <br />
                                  {{ empleado?.primerApellido }}
                                  {{ empleado?.primerNombre }}
                                  {{ empleado?.segundoNombre }}
                                  <br />
                                  {{ empleado?.numeroIdentificacion }}
                                  <br />
                                  {{ empleado?.usuario.email }}
                                </div>
                              </div>
                            </div>
                          </ng-template>
                        </p-autoComplete>
                        <label>Tipo de documento a solicitar:</label>
                        <p-dropdown
                          [options]="docSaludLaboral"
                          [(ngModel)]="item.docSolicitado"
                          required
                          styleClass="select-material"
                        ></p-dropdown>
                        <label>Fecha límite envío de documentación:</label>
                        <p-calendar
                          appendTo="body"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="yearRange"
                          [maxDate]="fechaActual"
                          [(ngModel)]="item.fechaLimite"
                          dateFormat="dd/mm/yy"
                        ></p-calendar>
                        <div>
                          <button
                            class="btn btn-danger btn-sm mt-2"
                            (click)="removeEmailSaludL(i)"
                          >
                            <i class="fas fa-times"></i> Eliminar
                          </button>
                        </div>
                      </div>
                      <hr class="divider" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </p-accordionTab>

          <p-accordionTab header="Psicosocial">
            <div class="container-fluid cew-9 grid">
              <div *ngIf="flag3" class="container-fluid">
                <div class="form-row">
                  <div class="col-12">
                    <label for="responsablePsicosocial">Responsable:</label>
                    <p-autoComplete
                      id="responsablePsicosocial"
                      styleClass="form-control-autocomplete"
                      placeholder="Digite"
                      [style]="{ width: '100%' }"
                      [suggestions]="empeladoListPsicosocial"
                      (completeMethod)="buscarEmpleadoPsicosocial($event)"
                      (onSelect)="selectResonsable($event, 'res4')"
                      [(ngModel)]="usuarioSolicitadoPsicosocial"
                    >
                      <ng-template let-empleado pTemplate="item">
                        <div class="ui-helper-clearfix">
                          <div class="wrapper">
                            <div class="empleado-info">
                              <br />
                              {{ empleado?.primerApellido }}
                              {{ empleado?.primerNombre }}
                              {{ empleado?.segundoNombre }}
                              <br />
                              {{ empleado?.numeroIdentificacion }}
                              <br />
                              {{ empleado?.usuario.email }}
                            </div>
                          </div>
                        </div>
                      </ng-template>
                    </p-autoComplete>
                  </div>
                </div>
                <div class="form-row mt-3">
                  <div class="col-12">
                    <label for="tipoDocumentoPsicosocial"
                      >Tipo de documento a solicitar:</label
                    >
                    <p-dropdown
                      id="tipoDocumentoPsicosiscial"
                      [options]="docPsicosocial"
                      [(ngModel)]="selectedDocPsicosocial"
                      required
                      styleClass="select-material"
                    ></p-dropdown>
                  </div>
                </div>
                <div class="form-row mt-3">
                  <div class="col-12">
                    <label for="fechaLimiteSeguridad"
                      >Fecha límite envío de documentación:</label
                    >
                    <p-calendar
                      id="fechaLimiteSeguridad"
                      appendTo="body"
                      [monthNavigator]="true"
                      [yearNavigator]="true"
                      [yearRange]="yearRange"
                      [maxDate]="fechaActual"
                      [formControl]="formulario.get('fechaLimite')"
                      dateFormat="dd/mm/yy"
                    ></p-calendar>
                  </div>
                </div>
                <div class="form-row mt-3">
                  <div class="col-12">
                    <button
                      class="btn btn-primary"
                      (click)="addEmailPsicosocial()"
                    >
                      <i class="fas fa-save"></i> Guardar selección
                    </button>
                  </div>
                </div>
                <div class="form-row mt-4">
                  <div class="col-12">
                    <h5>Correos para enviar:</h5>
                    <div
                      *ngFor="let item of psicosocial"
                      class="form-group saved-item"
                    >
                      <div class="saved-item-content">
                        <label>Responsable:</label>
                        <p-autoComplete
                          styleClass="form-control-autocomplete"
                          placeholder="Digite"
                          [style]="{ width: '100%' }"
                          [suggestions]="empeladoListPsicosocial"
                          (onSelect)="
                            selectResonsableSelectedPsicosocial(
                              $event,
                              'res4',
                              item
                            )
                          "
                          (completeMethod)="buscarEmpleadoPsicosocial($event)"
                          [(ngModel)]="item.usuarioSolicitado"
                        >
                          <ng-template let-empleado pTemplate="item">
                            <div class="ui-helper-clearfix">
                              <div class="wrapper">
                                <div class="empleado-info">
                                  <br />
                                  {{ empleado?.primerApellido }}
                                  {{ empleado?.primerNombre }}
                                  {{ empleado?.segundoNombre }}
                                  <br />
                                  {{ empleado?.numeroIdentificacion }}
                                  <br />
                                  {{ empleado?.usuario.email }}
                                </div>
                              </div>
                            </div>
                          </ng-template>
                        </p-autoComplete>
                        <label>Tipo de documento a solicitar:</label>
                        <p-dropdown
                          [options]="docPsicosocial"
                          [(ngModel)]="item.docSolicitado"
                          required
                          styleClass="select-material"
                        ></p-dropdown>
                        <label>Fecha límite envío de documentación:</label>
                        <p-calendar
                          appendTo="body"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="yearRange"
                          [maxDate]="fechaActual"
                          [(ngModel)]="item.fechaLimite"
                          dateFormat="dd/mm/yy"
                        ></p-calendar>
                        <div>
                          <button
                            class="btn btn-danger btn-sm mt-2"
                            (click)="removeEmailPsico(i)"
                          >
                            <i class="fas fa-times"></i> Eliminar
                          </button>
                        </div>
                      </div>
                      <hr class="divider" />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </p-accordionTab>
          <form [formGroup]="empleadoForm" (ngSubmit)="onSubmit()">
            <p-accordionTab header="Fecha de envio documentación">
              <div class="col-12">
                <label for="fechaLimite">Fecha de envio documentación:</label>
                <p-calendar
                  id="fechaCierreCaso"
                  appendTo="body"
                  [monthNavigator]="true"
                  [yearNavigator]="true"
                  [yearRange]="yearRange"
                  [maxDate]="fechaActual"
                  formControlName="fechaCierreCaso"
                  dateFormat="dd/mm/yy"
                ></p-calendar>
              </div>
              <div class="col">
                <div class="input-field">
                  <label for="" class="active"
                    >Entidad que solicito la documentación</label
                  >
                  <p-dropdown
                    appendTo="body"
                    [filter]="true"
                    [options]="emitPclentity"
                    formControlName="entidadEmiteCalificacion"
                    class="select-material"
                    styleClass="select-material"
                    [readonly]="true"
                    (onChange)="onEntidadChange($event)"
                  >
                  </p-dropdown>
                </div>
                <div class="col" *ngIf="selectedEntidad === 'otros'">
                  <div class="input-field">
                    <label for="" class="active"
                      >entidad que solicito la documentación</label
                    >
                    <input
                      type="text"
                      formControlName="otroDetalle"
                      class="form-control"
                    />
                  </div>
                </div>

                <!-- Dropdown para detalles -->
                <div class="col" *ngIf="isDetalleEnabled">
                  <div class="input-field">
                    <label for="" class="active"> Entidad</label>
                    <p-dropdown
                      appendTo="body"
                      [filter]="true"
                      [options]="detalleOptions"
                      formControlName="detalleCalificacion"
                      class="select-material"
                      styleClass="select-material"
                      [readonly]="true"
                    >
                    </p-dropdown>
                  </div>
                </div>
              </div>
              <ng-container>
                <button
                  pButton
                  type="button"
                  icon="bi bi-upload"
                  label="Adjuntar Soporte"
                  title="Subir documento"
                  [value]="documentacionSubirSelect"
                  class="p-button-info margin-left margin-right"
                  (click)="openUploadDialogCaseDT(idSl, documentosDT)"
                ></button>
              </ng-container>
              <s-documentoUpload
                [privadoCheck]="false"
                [(visible)]="flagDocDT"
                [modParam]="selectedDocIDDT"
                [modulo]="modulo"
                [tipoEvidencia]="'cargaDocumentosDT' + selectedDocIDDT"
                (onUpload)="onUploadCaseDT($event)"
              >
              </s-documentoUpload>
              <div class="ui-g" style="margin-top: 10px">
                <div class="ui-g-12 ui-sm-12 ui-md-10">
                  <div *ngFor="let doc of directorios">
                    <ng-container *ngIf="doc?.documento">
                      <table
                        class="caption-top"
                        *ngIf="
                          doc.documento.proceso === 'cargaDocumentosDT' + idSl
                        "
                      >
                        <p>Soportes:</p>
                        <thead>
                          <tr>
                            <th scope="col">Descripción</th>
                            <th scope="col">Opciones</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>
                              <a
                                type="button"
                                class="btn btn-outline-primary"
                                (click)="descargarDocumento(doc.documento)"
                                >{{ doc.documento.descripcion }}</a
                              >
                            </td>
                            <td>
                              <a>&nbsp;</a>
                              <a
                                type="button"
                                [ariaDisabled]="true"
                                class="btn btn-outline-danger"
                                title="Eliminar documento"
                                (click)="eliminarDocumentCaseDT(doc)"
                                ><span class="pi pi-trash"></span
                              ></a>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </ng-container>
                  </div>
                </div>
              </div>
            </p-accordionTab>
          </form>
          <form [formGroup]="empleadoForm" (ngSubmit)="onSubmit()">
            <p-accordionTab header="Fecha de notificacion del dictamen">
              <!-- <div class="row row-cols-1 row-cols-md-2 g-4">
                <div class="col">
                  <div class="card" style="padding: 2%">
                    <p-panel header="Dictamen de la EPS">
                    <p-dropdown
                      [options]="ePSDocs"
                      appendTo="body"
                      [filter]="true"
                      formControlName="selectedEps"
                      optionLabel="label"
                      placeholder="Seleccione una EPS"
                    >
                    </p-dropdown>

                    <label for="fechaLimite"
                      >Fecha notificacion de la empresa:</label
                    >
                    <p-calendar
                      id="fechaNotificacionEmp"
                      appendTo="body"
                      [monthNavigator]="true"
                      [yearNavigator]="true"
                      [yearRange]="yearRange"
                      [maxDate]="fechaActual"
                      formControlName="fechaNotificacionEmp"
                      dateFormat="dd/mm/yy"
                    ></p-calendar>

                    <button
                      pButton
                      type="button"
                      icon="bi bi-upload"
                      label="Adjuntar Soporte"
                      title="Subir documento"
                      [value]="documentacionSubirSelect"
                      class="p-button-info margin-left margin-right"
                      (click)="openUploadDialogCaseEmpresa(idSl, documentosEmp)"
                    ></button>

                    <s-documentoUpload
                      [privadoCheck]="false"
                      [(visible)]="flagDocEmp"
                      [modParam]="selectedDocEmp"
                      [modulo]="modulo"
                      [tipoEvidencia]="'cargaDocumentosEmp' + selectedDocEmp"
                      (onUpload)="onUploadCaseEmp($event)"
                    >
                    </s-documentoUpload>
                    <div class="ui-g" style="margin-top: 10px">
                      <div class="ui-g-12 ui-sm-12 ui-md-10">
                        <div *ngFor="let doc of directorios">
                          <ng-container *ngIf="doc?.documento">
                            <table
                              class="caption-top"
                              *ngIf="
                                doc.documento.proceso ===
                                'cargaDocumentosEmp' + idSl
                              "
                            >
                              <p>Soportes:</p>
                              <thead>
                                <tr>
                                  <th scope="col">Descripción</th>
                                  <th scope="col">Opciones</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr>
                                  <td>
                                    <a
                                      type="button"
                                      class="btn btn-outline-primary"
                                      (click)="
                                        descargarDocumento(doc.documento)
                                      "
                                      >{{ doc.documento.descripcion }}</a
                                    >
                                  </td>
                                  <td>
                                    <a>&nbsp;</a>
                                    <a
                                      type="button"
                                      [ariaDisabled]="true"
                                      class="btn btn-outline-danger"
                                      title="Eliminar documento"
                                      (click)="eliminarDocumentEmp(doc)"
                                      ><span class="pi pi-trash"></span
                                    ></a>
                                  </td>
                                </tr>
                              </tbody>
                            </table>
                          </ng-container>
                        </div>
                      </div>
                    </div>
                  </p-panel>
                  </div>
                  
                </div>
                <div class="col">
                  <div class="card">
                    <div class="card-body">
                      <p-panel header="Dictamen de la Junta Regional">
                        <p-dropdown
                          [options]="jrDocs"
                          appendTo="body"
                          [filter]="true"
                          formControlName="selectedArl"
                          optionLabel="label"
                          placeholder="Seleccione el departamento asociado"
                        >
                        </p-dropdown>
    
                        <label for="fechaLimite"
                          >Fecha notificacion de la empresa:</label
                        >
                        <p-calendar
                          id="fechaNotificacionEmp"
                          appendTo="body"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="yearRange"
                          [maxDate]="fechaActual"
                          formControlName="fechaNotificacionEmp"
                          dateFormat="dd/mm/yy"
                        ></p-calendar>
    
                        <button
                          pButton
                          type="button"
                          icon="bi bi-upload"
                          label="Adjuntar Soporte"
                          title="Subir documento"
                          [value]="documentacionSubirSelect"
                          class="p-button-info margin-left margin-right"
                          (click)="openUploadDialogCaseEmpresa(idSl, documentosEmp)"
                        ></button>
    
                        <s-documentoUpload
                          [privadoCheck]="false"
                          [(visible)]="flagDocEmp"
                          [modParam]="selectedDocEmp"
                          [modulo]="modulo"
                          [tipoEvidencia]="'cargaDocumentosEmp' + selectedDocEmp"
                          (onUpload)="onUploadCaseEmp($event)"
                        >
                        </s-documentoUpload>
                        <div class="ui-g" style="margin-top: 10px">
                          <div class="ui-g-12 ui-sm-12 ui-md-10">
                            <div *ngFor="let doc of directorios">
                              <ng-container *ngIf="doc?.documento">
                                <table
                                  class="caption-top"
                                  *ngIf="
                                    doc.documento.proceso ===
                                    'cargaDocumentosEmp' + idSl
                                  "
                                >
                                  <p>Soportes:</p>
                                  <thead>
                                    <tr>
                                      <th scope="col">Descripción</th>
                                      <th scope="col">Opciones</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td>
                                        <a
                                          type="button"
                                          class="btn btn-outline-primary"
                                          (click)="
                                            descargarDocumento(doc.documento)
                                          "
                                          >{{ doc.documento.descripcion }}</a
                                        >
                                      </td>
                                      <td>
                                        <a>&nbsp;</a>
                                        <a
                                          type="button"
                                          [ariaDisabled]="true"
                                          class="btn btn-outline-danger"
                                          title="Eliminar documento"
                                          (click)="eliminarDocumentEmp(doc)"
                                          ><span class="pi pi-trash"></span
                                        ></a>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </ng-container>
                            </div>
                          </div>
                        </div>
                      </p-panel>
                    </div>
                  </div>
                </div>
              </div>
              <div class="row row-cols-1 row-cols-md-2 g-4">
                <div class="col">
                  <div class="card">
                    <div class="card-body">
                      <p-panel header="Dictamen de la ARL">
                        <p-dropdown
                          [options]="arlDocs"
                          appendTo="body"
                          [filter]="true"
                          formControlName="selectedArl"
                          optionLabel="label"
                          placeholder="Seleccione una ARL"
                        >
                        </p-dropdown>
    
                        <label for="fechaLimite"
                          >Fecha notificacion de la empresa:</label
                        >
                        <p-calendar
                          id="fechaNotificacionEmp"
                          appendTo="body"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="yearRange"
                          [maxDate]="fechaActual"
                          formControlName="fechaNotificacionEmp"
                          dateFormat="dd/mm/yy"
                        ></p-calendar>
    
                        <button
                          pButton
                          type="button"
                          icon="bi bi-upload"
                          label="Adjuntar Soporte"
                          title="Subir documento"
                          [value]="documentacionSubirSelect"
                          class="p-button-info margin-left margin-right"
                          (click)="openUploadDialogCaseEmpresa(idSl, documentosEmp)"
                        ></button>
    
                        <s-documentoUpload
                          [privadoCheck]="false"
                          [(visible)]="flagDocEmp"
                          [modParam]="selectedDocEmp"
                          [modulo]="modulo"
                          [tipoEvidencia]="'cargaDocumentosEmp' + selectedDocEmp"
                          (onUpload)="onUploadCaseEmp($event)"
                        >
                        </s-documentoUpload>
                        <div class="ui-g" style="margin-top: 10px">
                          <div class="ui-g-12 ui-sm-12 ui-md-10">
                            <div *ngFor="let doc of directorios">
                              <ng-container *ngIf="doc?.documento">
                                <table
                                  class="caption-top"
                                  *ngIf="
                                    doc.documento.proceso ===
                                    'cargaDocumentosEmp' + idSl
                                  "
                                >
                                  <p>Soportes:</p>
                                  <thead>
                                    <tr>
                                      <th scope="col">Descripción</th>
                                      <th scope="col">Opciones</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td>
                                        <a
                                          type="button"
                                          class="btn btn-outline-primary"
                                          (click)="
                                            descargarDocumento(doc.documento)
                                          "
                                          >{{ doc.documento.descripcion }}</a
                                        >
                                      </td>
                                      <td>
                                        <a>&nbsp;</a>
                                        <a
                                          type="button"
                                          [ariaDisabled]="true"
                                          class="btn btn-outline-danger"
                                          title="Eliminar documento"
                                          (click)="eliminarDocumentEmp(doc)"
                                          ><span class="pi pi-trash"></span
                                        ></a>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </ng-container>
                            </div>
                          </div>
                        </div>
                      </p-panel>
                    </div>
                  </div>
                </div>
                <div class="col">
                  <div class="card">
                    <div class="card-body">
                      <p-panel header="Dictamen de la Junta Nacional">
                         <div class="input-field">
                    <input
                      type="text"
                      class="form-control"
                      value="Junta Nacional"
                      disabled
                    />
                  </div>
                 <br>
    
                        <label for="fechaLimite"
                          >Fecha notificacion de la empresa:</label
                        >
                        <p-calendar
                          id="fechaNotificacionEmp"
                          appendTo="body"
                          [monthNavigator]="true"
                          [yearNavigator]="true"
                          [yearRange]="yearRange"
                          [maxDate]="fechaActual"
                          formControlName="fechaNotificacionEmp"
                          dateFormat="dd/mm/yy"
                        ></p-calendar>
    
                        <button
                          pButton
                          type="button"
                          icon="bi bi-upload"
                          label="Adjuntar Soporte"
                          title="Subir documento"
                          [value]="documentacionSubirSelect"
                          class="p-button-info margin-left margin-right"
                          (click)="openUploadDialogCaseEmpresa(idSl, documentosEmp)"
                        ></button>
    
                        <s-documentoUpload
                          [privadoCheck]="false"
                          [(visible)]="flagDocEmp"
                          [modParam]="selectedDocEmp"
                          [modulo]="modulo"
                          [tipoEvidencia]="'cargaDocumentosEmp' + selectedDocEmp"
                          (onUpload)="onUploadCaseEmp($event)"
                        >
                        </s-documentoUpload>
                        <div class="ui-g" style="margin-top: 10px">
                          <div class="ui-g-12 ui-sm-12 ui-md-10">
                            <div *ngFor="let doc of directorios">
                              <ng-container *ngIf="doc?.documento">
                                <table
                                  class="caption-top"
                                  *ngIf="
                                    doc.documento.proceso ===
                                    'cargaDocumentosEmp' + idSl
                                  "
                                >
                                  <p>Soportes:</p>
                                  <thead>
                                    <tr>
                                      <th scope="col">Descripción</th>
                                      <th scope="col">Opciones</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td>
                                        <a
                                          type="button"
                                          class="btn btn-outline-primary"
                                          (click)="
                                            descargarDocumento(doc.documento)
                                          "
                                          >{{ doc.documento.descripcion }}</a
                                        >
                                      </td>
                                      <td>
                                        <a>&nbsp;</a>
                                        <a
                                          type="button"
                                          [ariaDisabled]="true"
                                          class="btn btn-outline-danger"
                                          title="Eliminar documento"
                                          (click)="eliminarDocumentEmp(doc)"
                                          ><span class="pi pi-trash"></span
                                        ></a>
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>
                              </ng-container>
                            </div>
                          </div>
                        </div>
                      </p-panel>
                    </div>
                  </div>
                </div>
              </div> -->

              <app-cargue-documentos-empresa
                [directorios]="this.directorios"
                [directoriosArl]="this.directoriosArl"
                [directoriosJr]="this.directoriosJr"
                [directoriosJn]="this.directoriosJn"
                [empleadoForm]="empleadoForm"
                (deleteDoc)="eliminarDocumentEmp($event)"
                
                
              ></app-cargue-documentos-empresa>
            </p-accordionTab>
          </form>

          <form [formGroup]="empleadoForm" (ngSubmit)="onSubmit()">
            <p-accordionTab header="Fecha de notificacion al ministerio">
              <div class="col-12">
                <label for="fechaLimite"
                  >Fecha notificacion al ministerio</label
                >
                <p-calendar
                  id="fechaNotificacionMin"
                  appendTo="body"
                  [monthNavigator]="true"
                  [yearNavigator]="true"
                  [yearRange]="yearRange"
                  [maxDate]="fechaActual"
                  formControlName="fechaNotificacionMin"
                  dateFormat="dd/mm/yy"
                ></p-calendar>
              </div>
              <ng-container>
                <button
                  pButton
                  type="button"
                  icon="bi bi-upload"
                  label="Adjuntar Soporte"
                  title="Subir documento"
                  [value]="documentacionSubirSelect"
                  class="p-button-info margin-left margin-right"
                  (click)="openUploadDialogCaseMinisterio(idSl, documentosMin)"
                ></button>
              </ng-container>
              <s-documentoUpload
                [privadoCheck]="false"
                [(visible)]="flagDocMin"
                [modParam]="selectedDocMin"
                [modulo]="modulo"
                [tipoEvidencia]="'cargaDocumentosMin' + selectedDocMin"
                (onUpload)="onUploadCaseMin($event)"
              >
              </s-documentoUpload>
              <div class="ui-g" style="margin-top: 10px">
                <div class="ui-g-12 ui-sm-12 ui-md-10">
                  <div *ngFor="let doc of directorios">
                    <ng-container *ngIf="doc?.documento">
                      <table
                        class="caption-top"
                        *ngIf="
                          doc.documento.proceso === 'cargaDocumentosMin' + idSl
                        "
                      >
                        <p>Soportes:</p>
                        <thead>
                          <tr>
                            <th scope="col">Descripción</th>
                            <th scope="col">Opciones</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>
                              <a
                                type="button"
                                class="btn btn-outline-primary"
                                (click)="descargarDocumento(doc.documento)"
                                >{{ doc.documento.descripcion }}</a
                              >
                            </td>
                            <td>
                              <a>&nbsp;</a>
                              <a
                                type="button"
                                [ariaDisabled]="true"
                                class="btn btn-outline-danger"
                                title="Eliminar documento"
                                (click)="eliminarDocumentMin(doc)"
                                ><span class="pi pi-trash"></span
                              ></a>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </ng-container>
                  </div>
                </div>
              </div>
            </p-accordionTab>
          </form>
        </p-accordion>
        <button
          pButton
          *sTienePermiso="'SCM_POST_CSL'"
          (click)="onSubmit(); submitEmp()"
          type="submit"
          icon="pi pi-save"
          class="float-btn"
          style="bottom: 200px"
          title="Guardar datos de Empleado"
          [disabled]="!this.empleadoForm.valid"
        ></button>
        <!-- Botón para enviar -->
        <button
          pButton
          (click)="abrirModalConfirmacion()"
          type="submit"
          icon="pi pi-envelope"
          class="float-btn"
          style="bottom: 100px"
          title="Enviar Correos"
        ></button>

        <!-- Modal de confirmación -->
        <p-dialog
          header="Confirmación de Envío"
          [(visible)]="modalConfirmacionVisible"
          [modal]="true"
          [closable]="false"
          [responsive]="true"
          [style]="{ width: '40vw', 'min-width': '300px' }"
        >
          <ng-template pTemplate="content">
            <p>¿Está seguro de enviar los correos electrónicos?</p>
          </ng-template>
          <ng-template pTemplate="footer">
            <button
              type="button"
              pButton
              (click)="
                onSubmiSLt(); onSubmiSLtSeg(); onSubmiSLl(); onSubmitPsico()
              "
              label="Enviar"
              class="p-button-success"
            ></button>
            <button
              type="button"
              pButton
              (click)="modalConfirmacionVisible = false"
              label="Cancelar"
              class="p-button-danger"
            ></button>
          </ng-template>
        </p-dialog>
      </p-tabPanel>
    </ng-container>

    <ng-container *sTienePermiso="'SCM_GET_DSR'">
      <p-tabPanel
        header="Documentación Solicitada al responsable"
        *ngIf="flagSaludLaboralRegistro"
      >
        <p-table
          #dt
          [value]="documentacionList"
          autoLayout="true"
          selectionMode="single"
          [(selection)]="documentacionSelectSolicitado"
          [rows]="10"
          [paginator]="true"
          dataKey="id"
          [lazy]="true"
        >
          <ng-template pTemplate="header">
            <tr>
              <th pSortableColumn="fechaSolicitud">Fecha de solicitud</th>
              <th pSortableColumn="asignacionTarea">Asignación de tareas</th>
              <th pSortableColumn="docSolicitado">
                Listado de documentos solicitados
              </th>
              <th pSortableColumn="responsable">Responsable</th>
              <th pSortableColumn="fechaLimite">
                Fecha límite envío de documentación
              </th>
              <th pSortableColumn="fechaEnvio">
                Fecha de envío de documentación
              </th>
              <th pSortableColumn="estadoCorreo">Estado</th>
              <th>Documento</th>
              <th pSortableColumn="razonRechazoSolicitado">Razón de rechazo</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-case>
            <tr [pSelectableRow]="case" class="table-row table-row-selectable">
              <td>{{ case.fechaSolicitud | date : "dd/MM/yyyy" }}</td>
              <td>{{ case.asignacionTarea }}</td>
              <td>
                <p>{{ case.docSolicitado }}</p>
              </td>
              <td>{{ case.usuarioSolicitado }}</td>
              <td>{{ case.fechaLimite | date : "dd/MM/yyyy" }}</td>
              <td>{{ case.fechaEnvio | date : "dd/MM/yyyy" }}</td>
              <td>{{ convertirEstadoCorreoUser(case.estadoCorreo) }}</td>
              <td>
                <!-- <button
            pButton
            type="button"
            icon="pi pi-download"
            title="Descargar documento"
            class="p-button-info margin-left margin-right"
          ></button> -->
                <div class="ui-g" style="margin-top: 10px">
                  <div class="ui-g-12 ui-sm-12 ui-md-10">
                    <div *ngFor="let doc of directorios">
                      <table
                        class="caption-top"
                        *ngIf="doc?.documento?.proceso === 'cargaDocumentosSL' + case.id"
                      >
                        <p>Soportes para Descargar:</p>

                        <tbody>
                          <tr>
                            <td>
                              <a
                                type="button"
                                class="btn btn-outline-primary"
                                (click)="descargarDocumento(doc.documento)"
                                >{{ doc.documento.descripcion }}</a
                              >
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </td>
              <td>{{ case.razonRechazoSolicitado }}</td>
            </tr>
          </ng-template>
          <ng-template pTemplate="summary" let-rowData>
            <button
              *sTienePermiso="'SCM_POST_RDS'"
              pButton
              type="button"
              icon="bi bi-check"
              label="Aprobar"
              class="p-button-info margin-left margin-right"
              [disabled]="
                !documentacionSelectSolicitado ||
                documentacionSelectSolicitado.documentos.length === 0
              "
              (click)="onEditState(documentacionSelectSolicitado.id)"
            ></button>
            <button
              *sTienePermiso="'SCM_POST_ADS'"
              pButton
              type="button"
              icon="bi bi-x"
              label="Rechazar"
              class="p-button-danger margin-left margin-right"
              [disabled]="
                !documentacionSelectSolicitado ||
                !documentacionSelectSolicitado.documentos ||
                documentacionSelectSolicitado.documentos.length === 0
              "
              (click)="dialogRechazoFlagSolicitante = true; getSelectedSoli()"
            ></button>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="9" class="p-text-center">
                No hay documentación solicitada.
              </td>
            </tr>
          </ng-template>
        </p-table>

        <!--hasta aca va la parte del solicitante-->
      </p-tabPanel>
    </ng-container>

    <ng-container *sTienePermiso="'SCM_GET_DQSR'">
      <p-tabPanel
        header="Documentación Solicitada"
        *ngIf="flagSaludLaboralRegistro"
      >
        <p-table
          #dt
          [value]="documentacionListUser"
          autoLayout="true"
          selectionMode="single"
          [(selection)]="documentacionSelectUser"
          [rows]="10"
          [paginator]="true"
          dataKey="id"
          [lazy]="true"
        >
          <ng-template pTemplate="header">
            <tr>
              <th pSortableColumn="fechaSolicitud">Fecha de solicitud</th>
              <th pSortableColumn="asignacionTarea">Asignación de tareas</th>
              <th pSortableColumn="listadoDocSolicitados">
                Listado de documentos solicitados
              </th>
              <th pSortableColumn="solicitante">Solicitante</th>
              <th pSortableColumn="UsuarioSolicitado">Trabajador Solicitado</th>
              <th pSortableColumn="fechaLimiteEnvioDoc">
                Fecha limite envío de documentación
              </th>
              <th pSortableColumn="fechaEnvioDoc">
                Fecha de envío de documentación
              </th>
              <th pSortableColumn="estado">Estado</th>
              <th pSortableColumn="razonRechazoSolicitante">Motivo Rechazo</th>
              <th>Documento</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-docsub>
            <tr
              [pSelectableRow]="docsub"
              class="table-row table-row-selectable"
            >
              <td>{{ docsub.fechaSolicitud | date : "dd/MM/yyyy" }}</td>
              <td>{{ docsub.asignacionTarea }}</td>
              <td>
                <p>{{ docsub.docSolicitado }}</p>
              </td>
              <td>
                {{ docsub.soliictanteNombres }} - {{ docsub.solicitanteCedula }}
              </td>
              <td>
                {{ docsub.solicitadoNombres }}- {{ docsub.solicitadoCedula }}
              </td>
              <td
                [class.fechaProxima]="
                  isFechaLimiteProxima(docsub.fechaLimite) &&
                  docsub.estadoCorreo !== 3
                "
              >
                {{ docsub.fechaLimite | date : "dd/MM/yyyy" }}
                <br />
                <span
                  *ngIf="
                    isFechaLimiteProxima(docsub.fechaLimite) &&
                    docsub.estadoCorreo !== 3
                  "
                  class="mensaje-proximo"
                  >Próximo a vencer</span
                >
              </td>

              <td>{{ docsub.fechaEnvio | date : "dd/MM/yyyy" }}</td>
              <td>{{ convertirEstadoCorreo(docsub.estadoCorreo) }}</td>
              <td>{{ docsub.razonRechazoSolicitante }}</td>
              <td>
                <ng-container>
                  <button
                    pButton
                    type="button"
                    icon="bi bi-upload"
                    title="Subir documento"
                    class="p-button-info margin-left margin-right"
                    (click)="openUploadDialog(docsub.id, docsub.documentos)"
                    [disabled]="
                      (docsub.documentos && docsub.documentos.length >= 3) ||
                      docsub.fechaLimite > fechaActual
                    "
                  ></button>
                </ng-container>
                <s-documentoUpload
                  [privadoCheck]="false"
                  [(visible)]="flagDoc"
                  [modParam]="selectedDocId"
                  [modulo]="modulo"
                  [tipoEvidencia]="'cargaDocumentosSL' + selectedDocId"
                  (onUpload)="onUpload($event)"
                >
                </s-documentoUpload>
                <div class="ui-g" style="margin-top: 10px">
                  <div class="ui-g-12 ui-sm-12 ui-md-10">
                    <div *ngFor="let doc of directorios">
                      <table
                        class="caption-top"
                        *ngIf="doc?.documento?.proceso === 'cargaDocumentosSL' + docsub.id"
                      >
                        <p>Soportes:</p>
                        <thead>
                          <tr>
                            <th scope="col">Descripción</th>
                            <th scope="col">Opciones</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr>
                            <td>
                              <span class="document-name">{{
                                doc.documento.descripcion
                              }}</span>
                            </td>
                            <td>
                              <a>&nbsp;</a>
                              <a
                                type="button"
                                [ariaDisabled]="true"
                                class="btn btn-outline-danger"
                                title="Eliminar documento"
                                (click)="eliminarDocument(doc)"
                                ><span class="pi pi-trash"></span
                              ></a>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </td>
            </tr>
          </ng-template>
          <ng-template pTemplate="summary" let-rowData>
            <!-- <button
            pButton
            type="button"
            icon="bi bi-search"
            label="Consultar trazabilidad"
            class="p-button-info margin-left margin-right"
            [disabled]="!documentacionSelectUser"
            (click)="dialogTrazabilidadFlag = true"
          ></button> -->
            <button
              pButton
              type="button"
              icon="bi bi-x"
              label="Rechazar"
              class="p-button-danger margin-left margin-right"
              [disabled]="!documentacionSelectUser"
              (click)="dialogRechazoFlag = true; getSelectedId()"
            ></button>
          </ng-template>
          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="9" class="p-text-center">
                No hay documentación solicitada.
              </td>
            </tr>
          </ng-template>
        </p-table>
      </p-tabPanel>
    </ng-container>
  </ng-container>
</p-tabView>

<p-dialog
  [header]="!diagSelect ? 'Crear Diagnóstico' : 'Editar Diagnóstico'"
  [(visible)]="modalDianostico"
  [modal]="true"
  [closable]="false"
  [draggable]="false"
  [resizable]="false"
  [responsive]="true"
  [style]="{ width: '50vw' }"
>
  <app-diagnostico-form
    *ngIf="saludLaboralSelect"
    [diagSelect]="diagSelect"
    [saludLaboralFlag]="true"
    [id]="saludLaboralSelect.pkUser"
    [caseId]="saludLaboralSelect.idSl"
    (eventClose)="onCloseModalDianostico()"
    (closeModal)="closeModalDiagnostico()"
  >
  </app-diagnostico-form>
</p-dialog>

<p-dialog
  [header]="'Rechazo documentación'"
  [(visible)]="dialogRechazoFlag"
  [modal]="true"
  [closable]="false"
  [draggable]="false"
  [resizable]="false"
  [responsive]="true"
  [style]="{ width: '50vw' }"
>
  <div class="grid">
    <div class="col-12">Detalle del porque se rechaza:</div>
    <div class="col-12">
      <textarea
        name="motivoRechazo"
        [(ngModel)]="motivoRechazo"
        cols="30"
        rows="10"
      ></textarea>
    </div>
    <div class="col-12">
      <button
        pButton
        type="button"
        icon="bi bi-check-lg"
        label="Aceptar"
        class="p-button-primary margin-left margin-right"
        (click)="putmail()"
      ></button>
      <button
        pButton
        type="button"
        icon="bi bi-x"
        label="Cancelar"
        class="p-button-danger margin-left margin-right"
        (click)="dialogRechazoFlag = false"
      ></button>
    </div>
  </div>
</p-dialog>
<p-dialog
  [header]="'Rechazo documentación'"
  [(visible)]="dialogRechazoFlagSolicitante"
  [modal]="true"
  [closable]="false"
  [draggable]="false"
  [resizable]="false"
  [responsive]="true"
  [style]="{ width: '50vw' }"
>
  <div class="grid">
    <div class="col-12">Detalle del porqué se rechaza:</div>
    <div class="col-12">
      <textarea
        name="motivoRechazoSolicitante"
        [(ngModel)]="motivoRechazoSolicitante"
        required
        cols="30"
        rows="10"
      ></textarea>
    </div>
    <div class="col-12">
      <label for="fechaLimite">Fecha Límite:</label>
      <p-calendar
        id="fechaLimite"
        [(ngModel)]="fechaLimite"
        required
        dateFormat="dd/mm/yy"
        appendTo="body"
        [monthNavigator]="true"
        [yearNavigator]="true"
        [yearRange]="'2020:2030'"
      ></p-calendar>
    </div>
    <div class="col-12">
      <button
        pButton
        type="button"
        icon="bi bi-check-lg"
        label="Aceptar"
        class="p-button-primary margin-left margin-right"
        (click)="putmailSoliictante()"
      ></button>
      <button
        pButton
        type="button"
        icon="bi bi-x"
        label="Cancelar"
        class="p-button-danger margin-left margin-right"
        (click)="dialogRechazoFlagSolicitante = false"
      ></button>
    </div>
  </div>
</p-dialog>

<p-dialog
  [header]="'Trazabilidad'"
  [(visible)]="dialogTrazabilidadFlag"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  [responsive]="true"
  [style]="{ width: '50vw' }"
>
  <div class="grid" style="margin: auto">
    <p-table
      #dt
      [value]="trazabilidadList"
      autoLayout="true"
      selectionMode="single"
      [(selection)]="trazabilidadSelect"
      [rows]="10"
      [paginator]="true"
      dataKey="id"
      [lazy]="true"
    >
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="accion">Acción</th>
          <th pSortableColumn="fecha">fecha & Hora</th>
          <th pSortableColumn="observacion">Observación</th>
          <th pSortableColumn="usuario">Usario que realizo</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-traz>
        <tr [pSelectableRow]="traz" class="table-row table-row-selectable">
          <td>{{ traz.accion }}</td>
          <td>{{ traz.fecha | date : "dd/MM/yyyy" }}</td>
          <td>{{ traz.observacion }}</td>
          <td>{{ traz.usuario }}</td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="4" class="p-text-center">
            No hay trazabilidad en este documento.
          </td>
        </tr>
      </ng-template>
    </p-table>
    <div class="col-12">
      <button
        pButton
        type="button"
        icon="bi bi-x"
        label="Cerrar"
        class="p-button-danger margin-left margin-right"
        (click)="dialogTrazabilidadFlag = false"
      ></button>
    </div>
  </div>
</p-dialog>

<p-dialog
  [header]="'Crear cargo actual'"
  [(visible)]="flagDialogCargoActual"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  [responsive]="true"
  [style]="{ width: '50vw' }"
>
  <div class="grid">
    <div class="col-12">
      <h1>Nombre del cargo actual nuevo</h1>
    </div>
    <div class="col-12">
      <input
        type="text"
        (input)="onInput($event.target.value)"
        [(ngModel)]="selectedItem"
        class="autocomplete-input"
      />
      <ul *ngIf="filteredSuggestions.length > 0" class="autocomplete-list">
        <li
          *ngFor="let suggestion of filteredSuggestions"
          (click)="onSelect(suggestion)"
          class="autocomplete-item"
        >
          {{ suggestion }}
        </li>
      </ul>
    </div>

    <div class="col-12" style="display: flex">
      <button
        pButton
        type="button"
        icon="bi bi-pencil"
        label="Crear"
        class="p-button-info margin-left margin-right"
        (click)="crearCargoActual()"
      ></button>
      <button
        pButton
        type="button"
        icon="bi bi-x"
        label="Cerrar"
        class="p-button-danger margin-left margin-right"
        (click)="flagDialogCargoActual = false; cargoActual = ''"
      ></button>
    </div>
  </div>
</p-dialog>
<a style="visibility: hidden" id="dwldLink"></a>
